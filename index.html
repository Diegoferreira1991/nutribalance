<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriBalance - Comida Saludable Equilibrada</title>
    
    <!-- Font Awesome para √≠cones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== VARI√ÅVEIS & RESET ===== */
        :root {
            --primary: #00B894;
            --primary-dark: #00A085;
            --secondary: #6C5CE7;
            --accent: #FD79A8;
            --warning: #FDCB6E;
            --dark: #2D3436;
            --gray: #636E72;
            --light: #F5F6FA;
            --white: #FFFFFF;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --shadow-strong: 0 15px 40px rgba(0, 0, 0, 0.12);
            --radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            padding-top: 75px;
            overflow-x: hidden;
        }
        
        /* ===== BANDEIRAS OFICIAIS ===== */
        .flags {
            position: fixed;
            top: 5px;
            right: 15px;
            display: flex;
            gap: 6px;
            z-index: 2000;
            background: rgba(255, 255, 255, 0.9);
            padding: 3px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .flag {
            width: 28px;
            height: 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            background-size: cover;
            background-position: center;
        }
        
        .flag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .flag.active {
            border-color: var(--primary);
            transform: scale(1.1);
        }
        
        .flag-br {
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Flag_of_Brazil.svg/320px-Flag_of_Brazil.svg.png');
        }
        
        .flag-bo {
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Flag_of_Bolivia.svg/320px-Flag_of_Bolivia.svg.png');
        }
        
        /* ===== HEADER EXTREMAMENTE COMPACTO ===== */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--white);
            padding: 2px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            z-index: 1000;
            transition: var(--transition);
            min-height: 65px;
        }
        
        .header.scrolled {
            padding: 0px 5%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            min-height: 62px;
        }
        
        /* LOGO MANTIDA NO TAMANHO ORIGINAL - 420x130px */
        .logo {
            display: flex;
            align-items: center;
            gap: 2px;
            cursor: pointer;
            margin-right: -35px;
        }
        
        .logo-icon {
            width: 420px;
            height: 130px;
            background: transparent;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            border: none;
            transition: var(--transition);
            margin-top: -5px;
            margin-bottom: -5px;
        }
        
        .logo-icon:hover {
            transform: scale(1.03);
        }
        
        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: left center;
        }
        
        .logo-text {
            display: none;
        }
        
        /* Menu - EXTREMAMENTE COMPACTADO */
        .nav {
            display: flex;
            gap: 12px;
            margin-left: -30px;
        }
        
        .nav a {
            text-decoration: none;
            color: var(--gray);
            font-weight: 600;
            font-size: 16px;
            position: relative;
            padding: 3px 0;
            transition: var(--transition);
            cursor: pointer;
            white-space: nowrap;
        }
        
        .nav a:hover,
        .nav a.active {
            color: var(--primary);
        }
        
        .nav a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s;
        }
        
        .nav a:hover::after,
        .nav a.active::after {
            width: 100%;
        }
        
        /* √Årea do usu√°rio - COMPACTADA */
        .user-area {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .login-btn, .logout-btn {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: var(--white);
            border: none;
            padding: 5px 16px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            position: relative;
            overflow: hidden;
        }
        
        .login-btn:hover, .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(108, 92, 231, 0.2);
        }
        
        .cart-btn {
            position: relative;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--dark);
            transition: var(--transition);
        }
        
        .cart-btn:hover {
            transform: scale(1.1);
            color: var(--primary);
        }
        
        .cart-count {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--accent);
            color: var(--white);
            font-size: 10px;
            font-weight: bold;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }
        
        /* Mobile menu button - COMPACTADO */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 22px;
            color: var(--dark);
            cursor: pointer;
            padding: 3px;
        }
        
        /* ===== WHATSAPP - CORRE√á√ÉO DEFINITIVA ===== */
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #25D366;
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            text-decoration: none;
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3);
            z-index: 1000;
            transition: var(--transition);
            animation: pulse-whatsapp 2s infinite;
        }
        
        .whatsapp-float:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 15px 35px rgba(37, 211, 102, 0.4);
        }
        
        /* ===== RESPONSIVO COM HEADER COMPACTADO ===== */
        @media (max-width: 1200px) {
            .logo-icon {
                width: 350px;
                height: 110px;
                margin-top: -3px;
                margin-bottom: -3px;
            }
            
            .nav {
                gap: 10px;
                margin-left: -25px;
            }
            
            .header {
                min-height: 62px;
                padding: 1px 5%;
            }
            
            .header.scrolled {
                min-height: 60px;
                padding: 0px 5%;
            }
            
            body {
                padding-top: 72px;
            }
        }
        
        @media (max-width: 992px) {
            .hero-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .hero-images {
                order: -1;
            }

            .hero-footer-phrase {
                grid-column: span 1;
            }
            
            .nav {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .table-header,
            .table-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .logo-icon {
                width: 280px;
                height: 90px;
                margin-top: -2px;
                margin-bottom: -2px;
            }
            
            .rankings-section {
                flex-direction: column;
            }
            
            .header {
                min-height: 60px;
                padding: 1px 5%;
            }
            
            .header.scrolled {
                min-height: 58px;
            }

            body {
                padding-top: 70px;
            }
        }
        
        @media (max-width: 768px) {
            .hero-text h1 {
                font-size: 2.2rem;
            }
            
            .hero {
                padding: 100px 5% 60px;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .flags {
                top: 5px;
                right: 8px;
                padding: 2px;
                gap: 4px;
            }
            
            .flag {
                width: 24px;
                height: 18px;
            }
            
            .cart-item {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .cart-item-image {
                width: 150px;
                height: 150px;
            }
            
            .checkout-steps {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .table-header,
            .table-row {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .logo-icon {
                width: 220px;
                height: 70px;
                margin-top: 0px;
                margin-bottom: 0px;
            }
            
            .logo {
                gap: 5px;
                margin-right: 0;
            }

            .header {
                padding: 0px 5%;
                min-height: 58px;
            }
            
            .header.scrolled {
                min-height: 56px;
                padding: 0px 5%;
            }

            body {
                padding-top: 65px;
            }
            
            .user-area {
                gap: 6px;
            }
            
            .login-btn, .logout-btn {
                padding: 4px 12px;
                font-size: 12px;
                gap: 4px;
            }
            
            .cart-btn {
                font-size: 18px;
            }
        }
        
        @media (max-width: 480px) {
            .logo-icon {
                width: 180px;
                height: 60px;
            }

            .header {
                padding: 0px 4%;
                min-height: 56px;
            }
            
            .header.scrolled {
                min-height: 54px;
            }

            body {
                padding-top: 60px;
            }
            
            .user-area {
                gap: 4px;
            }
            
            .login-btn, .logout-btn {
                padding: 3px 10px;
                font-size: 11px;
            }
            
            .cart-btn {
                font-size: 16px;
            }
            
            .flags {
                top: 4px;
                right: 6px;
            }
            
            .flag {
                width: 22px;
                height: 16px;
            }
        }
        
        /* ===== LOGIN MODAL ===== */
        .login-modal, .logout-modal, .register-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .login-content {
            background: var(--white);
            border-radius: var(--radius);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow-strong);
            position: relative;
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark);
            font-size: 1.8rem;
        }
        
        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .login-tab {
            flex: 1;
            padding: 12px;
            border: none;
            background: var(--light);
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .login-tab.active {
            background: var(--primary);
            color: var(--white);
        }
        
        .login-form {
            display: none;
        }
        
        .login-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
        }
        
        .form-input:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .login-error {
            color: var(--accent);
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
            display: none;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            color: var(--gray);
            cursor: pointer;
        }
        
        /* ===== HERO SECTION ===== */
        .hero {
            padding: 120px 5% 100px;
            background: linear-gradient(135deg, #e8f5e9 0%, #e3f2fd 100%);
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 184, 148, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(108, 92, 231, 0.1) 0%, transparent 20%);
            z-index: 0;
        }
        
        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
            position: relative;
            z-index: 1;
        }
        
        .hero-text h1 {
            font-size: 3.2rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 20px;
            color: var(--dark);
        }
        
        .hero-text h1 span {
            color: var(--primary);
            position: relative;
        }
        
        .hero-text p {
            font-size: 1.2rem;
            color: var(--gray);
            margin-bottom: 30px;
        }
        
        .hero-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        /* Galeria de fotos de marmitas */
        .hero-images {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            position: relative;
            perspective: 1000px;
        }
        
        .marmita-card {
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 10px 20px rgba(0, 0, 0, 0.06),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            transform-style: preserve-3d;
        }
        
        .marmita-card:hover {
            transform: 
                translateY(-15px) 
                rotateX(5deg) 
                rotateY(5deg);
            box-shadow: 
                0 30px 60px rgba(0, 0, 0, 0.15),
                0 15px 30px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .marmita-card::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 5%;
            width: 90%;
            height: 10px;
            background: radial-gradient(ellipse at center, rgba(0,0,0,0.2) 0%, transparent 70%);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .marmita-card:hover::after {
            opacity: 1;
        }
        
        .marmita-img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        
        .marmita-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: var(--white);
            padding: 10px;
            text-align: center;
            font-weight: 600;
        }

        /* NOVO: Container para a frase abaixo das imagens hero */
        .hero-footer-phrase {
            grid-column: span 2;
            text-align: center;
            margin-top: 20px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: var(--radius);
            backdrop-filter: blur(5px);
            font-size: 1.1rem;
            color: var(--dark);
            font-weight: 500;
            border-left: 4px solid var(--primary);
            box-shadow: var(--shadow);
        }
        
        /* ===== BOT√ïES ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 14px 32px;
            border-radius: var(--radius);
            font-weight: 700;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 16px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
            box-shadow: 0 10px 25px rgba(0, 184, 148, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 184, 148, 0.4);
        }
        
        .btn-secondary {
            background: var(--white);
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-5px);
        }
        
        /* ===== SE√á√ïES COMUNS ===== */
        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 50px;
            color: var(--dark);
            position: relative;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 2px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* ===== PRODUTOS ===== */
        .products-section {
            padding: 80px 5%;
            background: var(--white);
            position: relative;
            overflow: hidden;
        }
        
        .products-section::before {
            content: '';
            position: absolute;
            top: -50px;
            left: -50px;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(0, 184, 148, 0.05) 0%, transparent 70%);
            animation: float 20s infinite linear;
        }
        
        .products-section::after {
            content: '';
            position: absolute;
            bottom: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(108, 92, 231, 0.05) 0%, transparent 70%);
            animation: float 25s infinite linear reverse;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .product-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 2px solid transparent;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }
        
        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 100%);
            border-radius: var(--radius);
            z-index: -1;
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-strong);
            border-color: var(--primary);
        }
        
        .product-image {
            height: 200px;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .product-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .product-card:hover .product-img {
            transform: scale(1.05);
        }
        
        .product-info {
            padding: 25px;
        }
        
        .product-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .product-description {
            color: var(--gray);
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .product-macros {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            padding: 15px 0;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
        }
        
        .macro {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        
        .macro-value {
            font-weight: 700;
            color: var(--dark);
            font-size: 18px;
        }
        
        .macro-label {
            font-size: 12px;
            color: var(--gray);
            text-transform: uppercase;
        }
        
        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .product-price {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
        }
        
        .add-to-cart {
            background: var(--primary);
            color: var(--white);
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 20px;
        }
        
        .add-to-cart:hover {
            background: var(--primary-dark);
            transform: rotate(90deg) scale(1.1);
        }
        
        /* ===== P√ÅGINA DO CARRINHO ===== */
        .cart-page {
            display: none;
            padding: 100px 5% 80px;
            background: var(--light);
            min-height: 100vh;
        }
        
        .cart-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .cart-items {
            background: var(--white);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .cart-item {
            display: flex;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
            gap: 20px;
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-image {
            width: 100px;
            height: 100px;
            border-radius: var(--radius);
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .cart-item-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cart-item-info {
            flex: 1;
        }
        
        .cart-item-title {
            font-weight: 700;
            margin-bottom: 5px;
            font-size: 1.2rem;
        }
        
        .cart-item-price {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .cart-item-qty {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .cart-summary {
            background: var(--white);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .summary-total {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary);
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* ===== CHECKOUT PIX/QR CODE ===== */
        .checkout-section {
            display: none;
            padding: 100px 5% 80px;
            background: var(--light);
            min-height: 100vh;
        }
        
        .checkout-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .checkout-steps {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--light);
            color: var(--gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            border: 2px solid var(--light);
        }
        
        .step.active .step-number {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }
        
        .step.completed .step-number {
            background: var(--primary-dark);
            color: var(--white);
        }
        
        .step-label {
            font-size: 14px;
            color: var(--gray);
        }
        
        .step.active .step-label {
            color: var(--dark);
            font-weight: 600;
        }
        
        .qr-code-container {
            background: var(--white);
            border-radius: var(--radius);
            padding: 40px;
            text-align: center;
            box-shadow: var(--shadow-strong);
            margin-bottom: 30px;
        }
        
        .qr-code-img {
            max-width: 300px;
            width: 100%;
            margin: 20px auto;
            border-radius: var(--radius);
            border: 2px solid var(--light);
        }
        
        .pix-code {
            background: var(--light);
            padding: 15px;
            border-radius: var(--radius);
            margin: 20px 0;
            font-family: monospace;
            word-break: break-all;
            border: 2px dashed var(--primary);
        }
        
        .pix-instructions {
            text-align: left;
            margin-top: 30px;
            background: var(--light);
            padding: 20px;
            border-radius: var(--radius);
        }
        
        .pix-instructions li {
            margin-bottom: 10px;
            padding-left: 10px;
        }
        
        /* ===== PAINEL ADMIN ===== */
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 4000;
            overflow-y: auto;
            padding: 40px 20px;
        }
        
        .admin-content {
            background: var(--white);
            max-width: 1200px;
            margin: 0 auto;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow-strong);
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light);
        }
        
        .admin-title {
            font-size: 2rem;
            color: var(--dark);
        }
        
        .close-admin {
            background: none;
            border: none;
            font-size: 30px;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .close-admin:hover {
            color: var(--accent);
            transform: rotate(90deg);
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--light);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background: none;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .tab-btn.active {
            background: var(--primary);
            color: var(--white);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: var(--radius);
            font-size: 16px;
            min-height: 100px;
            resize: vertical;
        }
        
        .form-textarea:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .image-preview {
            width: 100%;
            height: 200px;
            background: var(--light);
            border-radius: var(--radius);
            margin-bottom: 15px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .upload-btn {
            background: var(--secondary);
            color: var(--white);
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-right: 10px;
        }
        
        .upload-input {
            display: none;
        }
        
        .qrcode-preview {
            max-width: 200px;
            margin: 20px auto;
            border-radius: var(--radius);
            border: 2px solid var(--light);
        }
        
        .product-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .product-item {
            background: var(--light);
            padding: 15px;
            border-radius: var(--radius);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .product-item-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-edit, .btn-delete {
            padding: 5px 10px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 12px;
        }
        
        .btn-edit {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-delete {
            background: var(--accent);
            color: var(--white);
        }
        
        /* ===== P√ÅGINAS DE CLIENTES E RELAT√ìRIOS ===== */
        .clients-section {
            display: none;
            padding: 100px 5% 80px;
            background: var(--light);
            min-height: 100vh;
        }
        
        .clients-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: var(--white);
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .clients-table {
            background: var(--white);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .table-header {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            background: var(--primary);
            color: var(--white);
            padding: 15px 20px;
            font-weight: 600;
        }
        
        .table-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        
        .table-row:hover {
            background: var(--light);
        }
        
        .table-row:last-child {
            border-bottom: none;
        }
        
        .birthday-badge {
            background: var(--accent);
            color: var(--white);
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-input {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: var(--radius);
            flex: 1;
            min-width: 200px;
        }
        
        /* ===== RANKING DE VENDAS ===== */
        .rankings-section {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .ranking-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            flex: 1;
            min-width: 300px;
        }
        
        .ranking-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--dark);
            text-align: center;
        }
        
        .ranking-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .ranking-item:last-child {
            border-bottom: none;
        }
        
        .ranking-position {
            width: 30px;
            height: 30px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .ranking-info {
            flex: 1;
        }
        
        .ranking-name {
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .ranking-value {
            color: var(--primary);
            font-weight: 700;
        }
        
        /* ===== FOOTER ===== */
        .footer {
            background: var(--dark);
            color: var(--white);
            padding: 60px 5% 30px;
            margin-top: 80px;
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-col h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }
        
        .footer-col h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--primary);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: #b2bec3;
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(5px);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .social-icon:hover {
            background: var(--primary);
            transform: translateY(-5px);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #b2bec3;
            font-size: 14px;
        }
        
        /* ===== ANIMA√á√ïES ===== */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes pulse-whatsapp {
            0% { box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3); }
            50% { box-shadow: 0 10px 25px rgba(37, 211, 102, 0.6); }
            100% { box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(40, 40);
                opacity: 0;
            }
        }
        
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(100px, 100px) rotate(360deg); }
        }
        
        @keyframes floatElement {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(10px) rotate(240deg); }
        }
        
        @keyframes badgePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* ===== LOADING ===== */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ===== NOTIFICA√á√ïES ===== */
        .custom-notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: var(--primary);
            color: white;
            padding: 15px 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-strong);
            z-index: 3000;
            animation: slideIn 0.3s ease;
            font-weight: 600;
            max-width: 350px;
            word-wrap: break-word;
        }
        
        /* ===== DB STATUS ===== */
        .db-status {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }
        
        /* ===== DEBUG TOOLS ===== */
        .debug-tools {
            position: fixed;
            bottom: 50px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 9999;
            display: none;
        }
        
        .debug-btn {
            background: red;
            color: white;
            border: none;
            padding: 5px;
            margin: 2px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        /* ===== BADGE PARA PRODUTOS EM DESTAQUE ===== */
        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, var(--accent), #FF6B9D);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            z-index: 2;
            box-shadow: 0 4px 15px rgba(253, 121, 168, 0.3);
            animation: badgePulse 2s infinite;
        }
        
        /* ===== FLUTUANDO ELEMENTOS DECORATIVOS ===== */
        .floating-element {
            position: absolute;
            z-index: -1;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <!-- ===== BANDEIRAS OFICIAIS ===== -->
    <div class="flags">
        <div class="flag flag-br" title="Portugu√™s (Brasil)" onclick="changeLanguage('pt')"></div>
        <div class="flag flag-bo active" title="Espa√±ol (Bolivia)" onclick="changeLanguage('es')"></div>
    </div>

    <!-- ===== STATUS DO BANCO DE DADOS ===== -->
    <div class="db-status" id="dbStatus">IndexedDB: Inicializando...</div>

    <!-- ===== DEBUG TOOLS (S√≥ aparece em localhost) ===== -->
    <div class="debug-tools" id="debugTools">
        <button class="debug-btn" onclick="clearAllData()">üóëÔ∏è Limpar Tudo</button>
        <button class="debug-btn" onclick="location.reload(true)">üîÑ Recarregar</button>
        <button class="debug-btn" onclick="showDebugInfo()">‚ÑπÔ∏è Info</button>
        <button class="debug-btn" onclick="forceAdminLogin()">üëë For√ßar Admin</button>
        <button class="debug-btn" onclick="testDataPersistence()">üíæ Testar Persist√™ncia</button>
    </div>

    <!-- ===== HEADER EXTREMAMENTE COMPACTADO ===== -->
    <header class="header" id="header">
        <div class="logo" onclick="goToHome()">
            <div class="logo-icon">
                <!-- LOGO MANTIDA NO TAMANHO ORIGINAL - 420x130px -->
                <img src="https://i.imgur.com/ooI2lHp.jpeg" alt="NutriBalance FITNESS" id="mainLogo">
            </div>
            <div class="logo-text">Nutri<span>Balance</span></div>
        </div>
        
        <nav class="nav">
            <a class="nav-link" data-section="inicio" data-es="Inicio" data-pt="In√≠cio" onclick="goToSection('inicio')">Inicio</a>
            <a class="nav-link" data-section="cardapio" data-es="Men√∫" data-pt="Card√°pio" onclick="goToSection('cardapio')">Men√∫</a>
            <a class="nav-link" data-section="combos" data-es="Combos" data-pt="Combos" onclick="goToSection('combos')">Combos</a>
            <a onclick="openCartPage()" data-es="Carrito" data-pt="Carrinho">Carrito</a>
        </nav>
        
        <div class="user-area">
            <button class="cart-btn" onclick="openCartPage()">
                üõí <span class="cart-count" id="cartCount">0</span>
            </button>
            
            <div id="userButtons">
                <button class="login-btn" onclick="openLoginModal()">
                    üë§ <span data-es="Iniciar Sesi√≥n" data-pt="Entrar">Iniciar Sesi√≥n</span>
                </button>
            </div>
            
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                ‚ò∞
            </button>
        </div>
    </header>

    <!-- ===== P√ÅGINAS PRINCIPAIS ===== -->
    <div id="mainContent">
        <!-- ===== HOME PAGE ===== -->
        <section class="hero" id="inicio">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 data-es="Equilibrio Nutricional en Cada Bocado" data-pt="Equil√≠brio Nutricional em Cada Mordida">
                        Equilibrio Nutricional en Cada Bocado
                    </h1>
                    <p data-es="Marmitas fitness preparadas por nutricionistas - solo calentar y disfrutar" 
                       data-pt="Marmitas fitness preparadas por nutricionistas - apenas aquecer e aproveitar">
                        Marmitas fitness preparadas por nutricionistas - solo calentar y disfrutar
                    </p>
                    
                    <!-- Frase din√¢mica de cadastro EM ESPA√ëOL -->
                    <div id="dynamicPhraseContainer" style="margin-bottom: 30px; display: none;">
                        <div style="background: rgba(0, 184, 148, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid var(--primary);">
                            <p id="dynamicPhrase" style="font-style: italic; color: var(--primary-dark); margin: 0; font-size: 16px;">
                                <!-- Frase ser√° inserida aqui via JavaScript -->
                            </p>
                        </div>
                    </div>
                    
                    <div class="hero-buttons">
                        <button class="btn btn-primary" onclick="goToSection('cardapio')">
                            üçΩÔ∏è <span data-es="Ver Men√∫" data-pt="Ver Card√°pio">Ver Men√∫</span>
                        </button>
                        <button class="btn btn-secondary" onclick="goToSection('combos')">
                            üéÅ <span data-es="Combos Promocionales" data-pt="Combos Promocionais">Combos Promocionales</span>
                        </button>
                    </div>
                </div>
                
                <div class="hero-images">
                    <div class="marmita-card">
                        <img src="https://i.imgur.com/8k7qQjL.jpeg" 
                             alt="Marmita de Carne" class="marmita-img" id="carneImage">
                        <div class="marmita-label" id="carneLabel" data-es="Carne Fitness" data-pt="Carne Fitness">Carne Fitness</div>
                    </div>
                    
                    <div class="marmita-card">
                        <img src="https://i.imgur.com/3yqWvzD.jpeg" 
                             alt="Marmita de Frango" class="marmita-img" id="frangoImage">
                        <div class="marmita-label" id="frangoLabel" data-es="Pollo Fitness" data-pt="Frango Fitness">Pollo Fitness</div>
                    </div>
                    
                    <!-- Frase abaixo das imagens hero -->
                    <div id="heroFooterPhraseContainer" class="hero-footer-phrase">
                        Comida saludable entregada en 24h
                    </div>
                    
                    <!-- Elementos decorativos -->
                    <div class="floating-element" style="top: 20px; right: -20px; width: 60px; height: 60px; background: rgba(0, 184, 148, 0.1); animation: floatElement 15s infinite ease-in-out;"></div>
                    <div class="floating-element" style="bottom: 40px; left: -30px; width: 80px; height: 80px; background: rgba(108, 92, 231, 0.1); animation: floatElement 20s infinite ease-in-out reverse;"></div>
                </div>
            </div>
        </section>

        <!-- ===== CARD√ÅPIO / MEN√ö ===== -->
        <section class="products-section" id="cardapio">
            <div class="container">
                <h2 class="section-title" data-es="ü•ó Nuestro Men√∫" data-pt="ü•ó Nosso Card√°pio">
                    ü•ó Nuestro Men√∫
                </h2>
                <div class="products-grid" id="productsGrid">
                    <!-- Produtos ser√£o carregados via JavaScript -->
                </div>
            </div>
        </section>

        <!-- ===== COMBOS ===== -->
        <section class="products-section" id="combos" style="background: var(--light);">
            <div class="container">
                <h2 class="section-title" data-es="üéÅ Combos Promocionales" data-pt="üéÅ Combos Promocionais">
                    üéÅ Combos Promocionales
                </h2>
                <div class="products-grid" id="combosGrid">
                    <!-- Combos ser√£o carregados via JavaScript -->
                </div>
            </div>
        </section>
    </div>

    <!-- ===== P√ÅGINA DO CARRINHO ===== -->
    <div class="cart-page" id="cartPage">
        <div class="cart-container">
            <h2 class="section-title" data-es="üõí Mi Carrito" data-pt="üõí Meu Carrinho">üõí Mi Carrito</h2>
            
            <div class="cart-items" id="cartPageItems">
                <!-- Itens do carrinho aparecem aqui -->
            </div>
            
            <div class="cart-summary">
                <div class="summary-row">
                    <span data-es="Subtotal" data-pt="Subtotal">Subtotal</span>
                    <span id="cartPageSubtotal">Bs 0,00</span>
                </div>
                <div class="summary-row">
                    <span id="deliveryLabel" data-es="Entrega" data-pt="Entrega">Entrega</span>
                    <span id="cartPageDelivery" data-es="Calcular via WhatsApp" data-pt="Calcular via WhatsApp">Calcular via WhatsApp</span>
                </div>
                <div class="summary-row summary-total">
                    <span data-es="Total" data-pt="Total">Total</span>
                    <span id="cartPageTotal">Bs 0,00</span>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="openCheckout()">
                    <i class="fas fa-lock"></i> <span data-es="Finalizar Pedido" data-pt="Finalizar Pedido">Finalizar Pedido</span>
                </button>
                
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="btn btn-secondary" style="flex: 1;" onclick="goToSection('cardapio')">
                        üçΩÔ∏è <span data-es="Men√∫" data-pt="Card√°pio">Men√∫</span>
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="goToSection('combos')">
                        üéÅ <span data-es="Combos" data-pt="Combos">Combos</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== CHECKOUT PIX/QR CODE ===== -->
    <div class="checkout-section" id="checkoutSection">
        <div class="checkout-container">
            <div class="checkout-steps">
                <div class="step completed">
                    <div class="step-number">1</div>
                    <div class="step-label" data-es="Carrito" data-pt="Carrinho">Carrito</div>
                </div>
                <div class="step active">
                    <div class="step-number">2</div>
                    <div class="step-label" data-es="Localizaci√≥n" data-pt="Localiza√ß√£o">Localizaci√≥n</div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-label" data-es="Pago" data-pt="Pagamento">Pago</div>
                </div>
            </div>
            
            <div class="qr-code-container">
                <h3><i class="fas fa-qrcode"></i> <span data-es="Pagamento apenas com QR Code" data-pt="Pagamento apenas com QR Code">Pagamento apenas con QR Code</span></h3>
                
                <div style="background: var(--light); padding: 20px; border-radius: var(--radius); margin: 20px 0; text-align: left;">
                    <p style="color: var(--primary); font-weight: 600;">
                        <i class="fas fa-info-circle"></i> 
                        <span data-es="Reciba el c√≥digo QR del valor total despu√©s de enviar su ubicaci√≥n por WhatsApp." 
                              data-pt="Receba o c√≥digo QR do valor total depois de enviar sua localiza√ß√£o pelo WhatsApp.">
                            Reciba el c√≥digo QR del valor total despu√©s de enviar su ubicaci√≥n por WhatsApp.
                        </span>
                    </p>
                </div>
                
                <!-- Campo de endere√ßo para entrega -->
                <div style="margin: 20px 0; text-align: left;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark);">
                        <i class="fas fa-map-marker-alt"></i> 
                        <span data-es="Localizaci√≥n para Entrega" data-pt="Localiza√ß√£o para Entrega">Localizaci√≥n para Entrega</span>
                    </label>
                    <textarea id="deliveryLocation" 
                              placeholder="Ingresa tu direcci√≥n completa (calle, n√∫mero, barrio, ciudad)..."
                              style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: var(--radius); min-height: 100px; resize: vertical;"></textarea>
                    <small style="color: var(--gray); display: block; margin-top: 5px;">
                        <span data-es="Esta informaci√≥n se enviar√° por WhatsApp para calcular la entrega y enviarte el c√≥digo QR para pago." 
                              data-pt="Esta informa√ß√£o ser√° enviada por WhatsApp para calcular a entrega e enviar o c√≥digo QR para pagamento.">
                            Esta informaci√≥n se enviar√° por WhatsApp para calcular la entrega y enviarte el c√≥digo QR para pago.
                        </span>
                    </small>
                </div>
                
                <div class="pix-instructions">
                    <h4><i class="fas fa-credit-card"></i> <span data-es="C√≥mo pagar:" data-pt="Como pagar:">C√≥mo pagar:</span></h4>
                    <ol>
                        <li>
                            <span data-es="Despu√©s de recibir el valor total de la entrega por WhatsApp" 
                                  data-pt="Depois que receber o valor total da entrega pelo WhatsApp">
                                Despu√©s de recibir el valor total de la entrega por WhatsApp
                            </span>
                        </li>
                        <li>
                            <span data-es="Abra su aplicaci√≥n de pagos" 
                                  data-pt="Abra seu aplicativo de pagamentos">
                                Abra su aplicaci√≥n de pagos
                            </span>
                        </li>
                        <li>
                            <span data-es="Seleccione 'Pagar con QR'" 
                                  data-pt="Selecione 'Pagar com QR'">
                                Seleccione 'Pagar con QR'
                            </span>
                        </li>
                        <li>
                            <span data-es="Escanee el c√≥digo QR enviado por WhatsApp" 
                                  data-pt="Escaneie o c√≥digo QR enviado pelo WhatsApp">
                                Escanee el c√≥digo QR enviado por WhatsApp
                            </span>
                        </li>
                        <li>
                            <span data-es="Confirme el pago" 
                                  data-pt="Confirme o pagamento">
                                Confirme el pago
                            </span>
                        </li>
                        <li>
                            <span data-es="Env√≠e el comprobante por WhatsApp" 
                                  data-pt="Envie o comprovante por WhatsApp">
                                Env√≠e el comprobante por WhatsApp
                            </span>
                        </li>
                        <li>
                            <span data-es="¬°Listo! Solo espere que llegue su pedido" 
                                  data-pt="Pronto! S√≥ aguardar seu pedido chegar">
                                ¬°Listo! Solo espere que llegue su pedido
                            </span>
                        </li>
                    </ol>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="sendOrderToWhatsApp()" id="sendOrderBtn">
                    <i class="fab fa-whatsapp"></i> 
                    <span data-es="Enviar Localizaci√≥n y Finalizar Pedido" data-pt="Enviar Localiza√ß√£o e Finalizar Pedido">Enviar Localizaci√≥n y Finalizar Pedido</span>
                </button>
                
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="btn btn-secondary" style="flex: 1;" onclick="goToCartPage()">
                        üõí <span data-es="Volver al Carrito" data-pt="Voltar ao Carrinho">Volver al Carrito</span>
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="goToSection('cardapio')">
                        üçΩÔ∏è <span data-es="Men√∫" data-pt="Card√°pio">Men√∫</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== P√ÅGINA DE CLIENTES (ADMIN) ===== -->
    <div class="clients-section" id="clientsSection">
        <div class="clients-container">
            <h2 class="section-title">üë• <span data-es="Gesti√≥n de Clientes" data-pt="Gest√£o de Clientes">Gesti√≥n de Clientes</span></h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalClients">0</div>
                    <div class="stat-label" data-es="Clientes Registrados" data-pt="Clientes Registrados">Clientes Registrados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalOrders">0</div>
                    <div class="stat-label" data-es="Pedidos Totales" data-pt="Pedidos Totais">Pedidos Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalRevenue">Bs 0,00</div>
                    <div class="stat-label" data-es="Ingresos Totales" data-pt="Receita Total">Ingresos Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="birthdaysCount">0</div>
                    <div class="stat-label" data-es="Cumplea√±os este mes" data-pt="Anivers√°rios este m√™s">Cumplea√±os este mes</div>
                </div>
            </div>
            
            <div class="filters">
                <input type="text" id="searchClient" class="filter-input" placeholder="Buscar cliente..." data-es="Buscar cliente..." data-pt="Buscar cliente...">
                <select id="filterMonth" class="filter-input">
                    <option value="">Todos los meses</option>
                    <option value="1">Enero</option>
                    <option value="2">Febrero</option>
                    <option value="3">Marzo</option>
                    <option value="4">Abril</option>
                    <option value="5">Mayo</option>
                    <option value="6">Junio</option>
                    <option value="7">Julio</option>
                    <option value="8">Agosto</option>
                    <option value="9">Septiembre</option>
                    <option value="10">Octubre</option>
                    <option value="11">Noviembre</option>
                    <option value="12">Diciembre</option>
                </select>
                <button class="btn btn-primary" onclick="loadClients()">
                    üîç <span data-es="Filtrar" data-pt="Filtrar">Filtrar</span>
                </button>
                <button class="btn btn-secondary" onclick="showRankingsPage()">
                    üìä <span data-es="Ver Rankings" data-pt="Ver Rankings">Ver Rankings</span>
                </button>
                <button class="btn btn-secondary" onclick="exportClientsReport()">
                    üì• <span data-es="Exportar Reporte" data-pt="Exportar Relat√≥rio">Exportar Reporte</span>
                </button>
            </div>
            
            <div class="clients-table">
                <div class="table-header">
                    <div data-es="Nombre" data-pt="Nome">Nombre</div>
                    <div data-es="Email" data-pt="Email">Email</div>
                    <div data-es="Pedidos" data-pt="Pedidos">Pedidos</div>
                    <div data-es="Total Gastado" data-pt="Total Gasto">Total Gastado</div>
                    <div data-es="Cumplea√±os" data-pt="Anivers√°rio">Cumplea√±os</div>
                </div>
                <div id="clientsTableBody">
                    <!-- Clientes ser√£o carregados aqui -->
                </div>
            </div>
            
            <!-- SE√á√ÉO: RANKINGS -->
            <div id="rankingsSection" style="display: none;">
                <div class="rankings-section">
                    <div class="ranking-card">
                        <h3 class="ranking-title">üèÜ Top 10 Clientes</h3>
                        <div id="topClientsRanking">
                            <!-- Ranking de clientes ser√° carregado aqui -->
                        </div>
                    </div>
                    
                    <div class="ranking-card">
                        <h3 class="ranking-title">üìà Productos M√°s Vendidos</h3>
                        <div id="topProductsRanking">
                            <!-- Ranking de produtos ser√° carregado aqui -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-secondary" style="flex: 1;" onclick="openAdmin()">
                    ‚öôÔ∏è <span data-es="Volver al Panel" data-pt="Voltar ao Painel">Volver al Panel</span>
                </button>
                <button class="btn btn-primary" style="flex: 1;" onclick="loadClients()">
                    üîÑ <span data-es="Actualizar" data-pt="Atualizar">Actualizar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ===== FOOTER ===== -->
    <footer class="footer" id="contacto">
        <div class="footer-grid">
            <div class="footer-col">
                <!-- LOGO NO FOOTER - TAMB√âM MAIOR -->
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                    <div class="logo-icon" style="width: 260px; height: 85px; background: transparent;">
                        <img src="https://i.imgur.com/ooI2lHp.jpeg" alt="NutriBalance FITNESS">
                    </div>
                    <h3 style="margin: 0; font-size: 1.5rem; display: none;">üçÉ NutriBalance</h3>
                </div>
                <p id="footerDescription" data-es="Tu equilibrio nutricional entregado en casa" 
                   data-pt="Seu equil√≠brio nutricional entregue em casa">
                    Tu equilibrio nutricional entregado en casa
                </p>
                <div class="social-links">
                    <a href="#" class="social-icon" id="instagramLink"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon" id="facebookLink"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="social-icon" id="tiktokLink"><i class="fab fa-tiktok"></i></a>
                    <a href="#" class="social-icon" id="whatsappLinkFooter"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            
            <div class="footer-col">
                <h3 data-es="Men√∫" data-pt="Menu">Men√∫</h3>
                <ul class="footer-links">
                    <li><a onclick="goToSection('inicio')"><i class="fas fa-chevron-right"></i> <span data-es="Inicio" data-pt="In√≠cio">Inicio</span></a></li>
                    <li><a onclick="goToSection('cardapio')"><i class="fas fa-chevron-right"></i> <span data-es="Men√∫" data-pt="Card√°pio">Men√∫</span></a></li>
                    <li><a onclick="goToSection('combos')"><i class="fas fa-chevron-right"></i> <span data-es="Combos" data-pt="Combos">Combos</span></a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3 data-es="Contacto" data-pt="Contato">Contacto</h3>
                <ul class="footer-links">
                    <li><a href="#" id="footerWhatsapp"><i class="fab fa-whatsapp"></i> <span data-es="WhatsApp" data-pt="WhatsApp">WhatsApp</span>: <span id="footerWhatsappNumber">+591 771 23456</span></a></li>
                    <li><a href="mailto:hola@nutribalance.com" id="footerEmail"><i class="fas fa-envelope"></i> <span id="footerEmailText">hola@nutribalance.com</span></a></li>
                    <li><a href="#" id="footerAddress"><i class="fas fa-map-marker-alt"></i> <span data-es="Santa Cruz de la Sierra, Bolivia" data-pt="Santa Cruz de la Sierra, Bol√≠via" id="footerAddressText">Santa Cruz de la Sierra, Bolivia</span></a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3 data-es="M√©todos de Pago" data-pt="M√©todos de Pagamento">M√©todos de Pago</h3>
                <ul class="footer-links">
                    <li><a href="#"><i class="fas fa-qrcode"></i> <span data-es="QR Code" data-pt="QR Code">QR Code</span></a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p id="footerCopyright">¬© 2026 NutriBalance. <span data-es="Todos los derechos reservados" data-pt="Todos os direitos reservados">Todos los derechos reservados</span>.</p>
            <p style="margin-top: 10px; font-size: 12px; color: #95a5a6;">
                <i class="fas fa-exclamation-circle"></i> 
                <span data-es="Una alimentaci√≥n equilibrada forma parte de un estilo de vida saludable. Consulte siempre a un nutricionista." 
                      data-pt="Uma alimenta√ß√£o equilibrada faz parte de um estilo de vida saud√°vel. Consulte sempre um nutricionista.">
                    Una alimentaci√≥n equilibrada forma parte de un estilo de vida saludable. Consulte siempre a un nutricionista.
                </span>
            </p>
        </div>
    </footer>

    <!-- ===== WHATSAPP - CORRE√á√ÉO DEFINITIVA ===== -->
    <a href="#" class="whatsapp-float" target="_blank" id="whatsappFloat">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- ===== MODAL DE LOGIN ===== -->
    <div class="login-modal" id="loginModal">
        <div class="login-content">
            <button class="close-modal" onclick="closeLoginModal()">&times;</button>
            <h2 class="login-title" data-es="Iniciar Sesi√≥n" data-pt="Entrar">Iniciar Sesi√≥n</h2>
            
            <div class="login-tabs">
                <button class="login-tab active" onclick="openLoginTab('client')" data-es="Cliente" data-pt="Cliente">Cliente</button>
                <button class="login-tab" onclick="openLoginTab('admin')" data-es="Administrador" data-pt="Administrador">Administrador</button>
            </div>
            
            <!-- Login Cliente -->
            <div class="login-form active" id="clientLogin">
                <div class="form-group">
                    <label class="form-label" data-es="Email" data-pt="Email">Email</label>
                    <input type="email" class="form-input" id="clientEmail" placeholder="ejemplo@gmail.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Contrase√±a" data-pt="Senha">Contrase√±a</label>
                    <input type="password" class="form-input" id="clientPassword">
                </div>
                
                <p class="login-error" id="clientError"></p>
                
                <button class="btn btn-primary" style="width: 100%;" onclick="loginClient()">
                    <span data-es="Ingresar como Cliente" data-pt="Entrar como Cliente">Ingresar como Cliente</span>
                </button>
                
                <p style="text-align: center; margin-top: 20px; color: var(--gray);">
                    <span data-es="¬øPrimera vez?" data-pt="Primeira vez?">¬øPrimera vez?</span>
                    <a href="#" style="color: var(--primary);" onclick="openRegisterModal()">
                        <span data-es="Crear cuenta" data-pt="Criar conta">Crear cuenta</span>
                    </a>
                </p>
            </div>
            
            <!-- Login Admin -->
            <div class="login-form" id="adminLogin">
                <div class="form-group">
                    <label class="form-label" data-es="Usuario Admin" data-pt="Usu√°rio Admin">Usuario Admin</label>
                    <input type="text" class="form-input" id="adminUser" placeholder="1">
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Contrase√±a" data-pt="Senha">Contrase√±a</label>
                    <input type="password" class="form-input" id="adminPassword" placeholder="1">
                </div>
                
                <p class="login-error" id="adminError"></p>
                
                <button class="btn btn-primary" style="width: 100%;" onclick="loginAdmin()">
                    <span data-es="Ingresar como Admin" data-pt="Entrar como Admin">Ingresar como Admin</span>
                </button>
            </div>
            
            <button class="btn btn-secondary" style="width: 100%; margin-top: 15px;" onclick="closeLoginModal()">
                <span data-es="Cancelar" data-pt="Cancelar">Cancelar</span>
            </button>
        </div>
    </div>

    <!-- ===== MODAL DE REGISTRO ===== -->
    <div class="register-modal" id="registerModal">
        <div class="login-content">
            <button class="close-modal" onclick="closeRegisterModal()">&times;</button>
            <h2 class="login-title" data-es="Crear Cuenta" data-pt="Criar Conta">Crear Cuenta</h2>
            
            <div class="login-tabs">
                <button class="login-tab active" onclick="openRegisterTab('personal')" data-es="Datos Personales" data-pt="Dados Pessoais">Datos Personales</button>
            </div>
            
            <form id="registerForm" onsubmit="registerClient(event)">
                <div class="form-group">
                    <label class="form-label" data-es="Nombre Completo" data-pt="Nome Completo">Nombre Completo</label>
                    <input type="text" class="form-input" id="registerName" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Email" data-pt="Email">Email</label>
                    <input type="email" class="form-input" id="registerEmail" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Tel√©fono" data-pt="Telefone">Tel√©fono</label>
                    <input type="tel" class="form-input" id="registerPhone" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Fecha de Nacimiento" data-pt="Data de Nascimento">Fecha de Nacimiento</label>
                    <input type="date" class="form-input" id="registerBirthday" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Contrase√±a" data-pt="Senha">Contrase√±a</label>
                    <input type="password" class="form-input" id="registerPassword" required minlength="6">
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Confirmar Contrase√±a" data-pt="Confirmar Senha">Confirmar Contrase√±a</label>
                    <input type="password" class="form-input" id="registerConfirmPassword" required minlength="6">
                </div>
                
                <p class="login-error" id="registerError"></p>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;" id="registerBtn">
                    <span data-es="Crear Cuenta" data-pt="Criar Conta">Crear Cuenta</span>
                </button>
            </form>
            
            <p style="text-align: center; margin-top: 20px; color: var(--gray);">
                <span data-es="¬øYa tienes cuenta?" data-pt="J√° tem conta?">¬øYa tienes cuenta?</span>
                <a href="#" style="color: var(--primary);" onclick="openLoginModalFromRegister()">
                    <span data-es="Iniciar Sesi√≥n" data-pt="Entrar">Iniciar Sesi√≥n</span>
                </a>
            </p>
            
            <button class="btn btn-secondary" style="width: 100%; margin-top: 15px;" onclick="closeRegisterModal()">
                <span data-es="Cancelar" data-pt="Cancelar">Cancelar</span>
            </button>
        </div>
    </div>

    <!-- ===== MODAL DE LOGOUT ===== -->
    <div class="logout-modal" id="logoutModal">
        <div class="login-content">
            <h2 class="login-title" id="logoutTitle"></h2>
            <p style="text-align: center; margin-bottom: 30px; color: var(--gray);" id="logoutMessage"></p>
            
            <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="logout()">
                <span data-es="Cerrar Sesi√≥n" data-pt="Sair">Cerrar Sesi√≥n</span>
            </button>
            
            <button class="btn btn-secondary" style="width: 100%;" onclick="closeLogoutModal()">
                <span data-es="Cancelar" data-pt="Cancelar">Cancelar</span>
            </button>
        </div>
    </div>

    <!-- ===== PAINEL ADMIN ===== -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-content">
            <div class="admin-header">
                <!-- LOGO NO PAINEL ADMIN -->
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div class="logo-icon" style="width: 200px; height: 70px; background: transparent;">
                        <img src="https://i.imgur.com/ooI2lHp.jpeg" alt="NutriBalance FITNESS">
                    </div>
                    <h2 class="admin-title"><span data-es="Panel de Administraci√≥n" data-pt="Painel de Administra√ß√£o">Panel de Administraci√≥n</span></h2>
                </div>
                <button class="close-admin" onclick="closeAdmin()">&times;</button>
            </div>
            
            <div class="admin-tabs">
                <button class="tab-btn active" onclick="openTab('productsTab')">üì¶ <span data-es="Productos" data-pt="Produtos">Productos</span></button>
                <button class="tab-btn" onclick="openTab('addProductTab')">‚ûï <span data-es="Agregar Producto" data-pt="Adicionar Produto">Agregar Producto</span></button>
                <button class="tab-btn" onclick="openTab('heroImagesTab')">üñºÔ∏è <span data-es="Im√°genes Hero" data-pt="Imagens Hero">Im√°genes Hero</span></button>
                <button class="tab-btn" onclick="openTab('qrCodeTab')">üì± <span data-es="QR Code Pago" data-pt="QR Code Pagamento">QR Code Pago</span></button>
                <button class="tab-btn" onclick="openTab('clientsTab')">üë• <span data-es="Clientes" data-pt="Clientes">Clientes</span></button>
                <button class="tab-btn" onclick="openTab('storeInfoTab')">üè™ <span data-es="Informaci√≥n Tienda" data-pt="Informa√ß√£o Loja">Informaci√≥n Tienda</span></button>
                <button class="tab-btn" onclick="openTab('settingsTab')">‚öôÔ∏è <span data-es="Configuraci√≥n" data-pt="Configura√ß√£o">Configuraci√≥n</span></button>
            </div>
            
            <!-- Tab: Lista de Productos -->
            <div class="tab-content active" id="productsTab">
                <h3 data-es="Gesti√≥n de Productos" data-pt="Gest√£o de Produtos">Gesti√≥n de Productos</h3>
                <div class="product-list" id="adminProductList">
                    <!-- Productos ser√£o listados aqui -->
                </div>
            </div>
            
            <!-- Tab: Agregar/Editar Producto -->
            <div class="tab-content" id="addProductTab">
                <h3 id="formTitle" data-es="Agregar Nuevo Producto" data-pt="Adicionar Novo Produto">Agregar Nuevo Producto</h3>
                <form id="productForm" onsubmit="saveProduct(event)">
                    <input type="hidden" id="editProductId">
                    
                    <div class="form-group">
                        <label class="form-label" data-es="Tipo" data-pt="Tipo">Tipo</label>
                        <select class="form-input" id="productType" required>
                            <option value="product" data-es="Producto Individual" data-pt="Produto Individual">Producto Individual</option>
                            <option value="combo" data-es="Combo Promocional" data-pt="Combo Promocional">Combo Promocional</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nombre (ES)</label>
                        <input type="text" class="form-input" id="nameEs" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nombre (PT)</label>
                        <input type="text" class="form-input" id="namePt" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Descripci√≥n (ES)</label>
                        <textarea class="form-textarea" id="descriptionEs" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Descripci√≥n (PT)</label>
                        <textarea class="form-textarea" id="descriptionPt" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" id="priceLabel">Precio (Bs)</label>
                        <input type="number" step="0.01" class="form-input" id="price" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Calor√≠as (kcal)</label>
                        <input type="number" class="form-input" id="calories">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Prote√≠nas (g)</label>
                        <input type="number" step="0.1" class="form-input" id="protein">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Carbohidratos (g)</label>
                        <input type="number" step="0.1" class="form-input" id="carbs">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Grasas (g)</label>
                        <input type="number" step="0.1" class="form-input" id="fat">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" data-es="Imagen del Producto" data-pt="Imagem do Produto">Imagen del Producto</label>
                        <div class="image-preview">
                            <img id="imagePreview" src="" alt="Vista previa">
                        </div>
                        <input type="text" class="form-input" id="imageUrl" 
                               placeholder="https://ejemplo.com/imagen.jpg" 
                               style="margin-bottom: 10px;">
                        <small style="display: block; margin-bottom: 10px;">O sube una imagen desde tu computadora:</small>
                        <input type="file" class="upload-input" id="imageUpload" accept="image/*" onchange="uploadImage(this, 'imagePreview', 'imageUrl')">
                        <button type="button" class="upload-btn" onclick="document.getElementById('imageUpload').click()">
                            <i class="fas fa-upload"></i> <span data-es="Subir Imagen" data-pt="Enviar Imagem">Subir Imagen</span>
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" data-es="Categor√≠a" data-pt="Categoria">Categor√≠a</label>
                        <select class="form-input" id="category">
                            <option value="carne" data-es="Carne" data-pt="Carne">Carne</option>
                            <option value="pollo" data-es="Pollo" data-pt="Frango">Pollo</option>
                            <option value="pescado" data-es="Pescado" data-pt="Peixe">Pescado</option>
                            <option value="vegano" data-es="Vegano" data-pt="Vegano">Vegano</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" id="saveProductBtn">
                        üíæ <span data-es="Guardar Producto" data-pt="Salvar Produto">Guardar Producto</span>
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="clearForm()">üîÑ <span data-es="Limpiar" data-pt="Limpar">Limpiar</span></button>
                </form>
            </div>
            
            <!-- Tab: Imagens Hero -->
            <div class="tab-content" id="heroImagesTab">
                <h3 data-es="Im√°genes de la Secci√≥n Hero" data-pt="Imagens da Se√ß√£o Hero">Im√°genes de la Secci√≥n Hero</h3>
                
                <div class="form-group">
                    <label class="form-label" data-es="Imagen de Marmita 1" data-pt="Imagem de Marmita 1">Imagen de Marmita 1</label>
                    <div class="image-preview" id="carnePreviewContainer">
                        <div id="carnePlaceholder" style="display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--gray);">
                            <i class="fas fa-hamburger" style="font-size: 40px; margin-bottom: 10px;"></i>
                            <span data-es="Sin imagen - Haz clic para cargar" data-pt="Sem imagem - Clique para carregar">Sin imagen - Haz clic para cargar</span>
                        </div>
                        <img id="heroCarnePreview" src="" alt="Marmita 1" style="display: none;">
                    </div>
                    <input type="text" class="form-input" id="heroCarneUrl" 
                           placeholder="URL de la imagen para marmita 1 o sube una imagen"
                           style="margin-bottom: 10px;">
                    <input type="file" class="upload-input" id="heroCarneUpload" accept="image/*" onchange="uploadHeroImage(this, 'heroCarnePreview', 'heroCarneUrl', 'carnePreviewContainer')">
                    <button type="button" class="upload-btn" onclick="document.getElementById('heroCarneUpload').click()">
                        <i class="fas fa-upload"></i> <span data-es="Subir Imagen" data-pt="Enviar Imagem">Subir Imagen</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Imagen de Marmita 2" data-pt="Imagem de Marmita 2">Imagen de Marmita 2</label>
                    <div class="image-preview" id="frangoPreviewContainer">
                        <div id="frangoPlaceholder" style="display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--gray);">
                            <i class="fas fa-drumstick-bite" style="font-size: 40px; margin-bottom: 10px;"></i>
                            <span data-es="Sin imagen - Haz clic para cargar" data-pt="Sem imagem - Clique para carregar">Sin imagen - Haz clic para cargar</span>
                        </div>
                        <img id="heroFrangoPreview" src="" alt="Marmita 2" style="display: none;">
                    </div>
                    <input type="text" class="form-input" id="heroFrangoUrl" 
                           placeholder="URL de la imagen para marmita 2 o sube una imagen"
                           style="margin-bottom: 10px;">
                    <input type="file" class="upload-input" id="heroFrangoUpload" accept="image/*" onchange="uploadHeroImage(this, 'heroFrangoPreview', 'heroFrangoUrl', 'frangoPreviewContainer')">
                    <button type="button" class="upload-btn" onclick="document.getElementById('heroFrangoUpload').click()">
                        <i class="fas fa-upload"></i> <span data-es="Subir Imagen" data-pt="Enviar Imagem">Subir Imagen</span>
                    </button>
                </div>
                
                <button class="btn btn-primary" onclick="saveHeroImages()" id="saveHeroImagesBtn">
                    üíæ <span data-es="Guardar Im√°genes" data-pt="Salvar Imagens">Guardar Im√°genes</span>
                </button>
            </div>
            
            <!-- Tab: Clientes -->
            <div class="tab-content" id="clientsTab">
                <h3 data-es="Gesti√≥n de Clientes" data-pt="Gest√£o de Clientes">Gesti√≥n de Clientes</h3>
                <p data-es="Ver y gestionar todos los clientes registrados" data-pt="Ver e gerenciar todos os clientes registrados">
                    Ver y gestionar todos los clientes registrados
                </p>
                
                <div class="filters" style="margin-bottom: 20px;">
                    <input type="text" id="adminSearchClient" class="filter-input" placeholder="Buscar cliente..." style="flex: 2;">
                    <input type="number" id="adminMinOrders" class="filter-input" placeholder="M√≠n. pedidos" style="flex: 1;">
                    <input type="number" id="adminMinSpent" class="filter-input" placeholder="M√≠n. gastado" style="flex: 1;">
                    <button class="btn btn-primary" onclick="loadAdminClients()">
                        üîç <span data-es="Buscar" data-pt="Buscar">Buscar</span>
                    </button>
                    <button class="btn btn-secondary" onclick="showClientsPage()">
                        üìã <span data-es="Ver Reporte Completo" data-pt="Ver Relat√≥rio Completo">Ver Reporte Completo</span>
                    </button>
                </div>
                
                <div class="product-list" id="adminClientsList" style="max-height: 500px;">
                    <!-- Clientes ser√£o listados aqui -->
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: var(--light); border-radius: var(--radius);">
                    <h4><i class="fas fa-birthday-cake"></i> <span data-es="Pr√≥ximos Cumplea√±os" data-pt="Pr√≥ximos Anivers√°rios">Pr√≥ximos Cumplea√±os</span></h4>
                    <div id="upcomingBirthdays"></div>
                </div>
            </div>
            
            <!-- Tab: QR Code Pago -->
            <div class="tab-content" id="qrCodeTab">
                <h3 data-es="Configuraci√≥n de Pago QR" data-pt="Configura√ß√£o de Pagamento QR">Configuraci√≥n de Pago QR</h3>
                <p data-es="Sube la imagen del c√≥digo QR para pagos" data-pt="Envie a imagem do c√≥digo QR para pagamentos">
                    Sube la imagen del c√≥digo QR para pagos
                </p>
                
                <div class="form-group">
                    <label class="form-label" data-es="QR Code para Pagos" data-pt="QR Code para Pagamentos">QR Code para Pagos</label>
                    <div class="image-preview">
                        <img id="qrcodePreview" src="" alt="QR Code">
                    </div>
                    <input type="text" class="form-input" id="qrcodeUrl" 
                           placeholder="URL de la imagen del QR Code"
                           style="margin-bottom: 10px;">
                    <input type="file" class="upload-input" id="qrcodeUpload" accept="image/*" onchange="uploadImage(this, 'qrcodePreview', 'qrcodeUrl')">
                    <button type="button" class="upload-btn" onclick="document.getElementById('qrcodeUpload').click()">
                        <i class="fas fa-upload"></i> <span data-es="Subir QR Code" data-pt="Enviar QR Code">Subir QR Code</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="C√≥digo PIX (Opcional)" data-pt="C√≥digo PIX (Opcional)">C√≥digo PIX (Opcional)</label>
                    <input type="text" class="form-input" id="pixCodeInput" placeholder="00020126580014BR.GOV.BCB.PIX...">
                </div>
                
                <button class="btn btn-primary" onclick="saveQRCode()" id="saveQRCodeBtn">
                    üíæ <span data-es="Guardar QR Code" data-pt="Salvar QR Code">Guardar QR Code</span>
                </button>
            </div>
            
            <!-- Tab: Informaci√≥n de la Tienda -->
            <div class="tab-content" id="storeInfoTab">
                <h3 data-es="Informaci√≥n de la Tienda" data-pt="Informa√ß√£o da Loja">Informaci√≥n de la Tienda</h3>
                
                <div class="form-group">
                    <label class="form-label" data-es="Descripci√≥n del Footer" data-pt="Descri√ß√£o do Rodap√©">Descripci√≥n del Footer</label>
                    <textarea class="form-textarea" id="footerDescriptionInput" placeholder="Tu equilibrio nutricional entregado en casa">Tu equilibrio nutricional entregado en casa</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Redes Sociales" data-pt="Redes Sociais">Redes Sociales</label>
                    <input type="text" class="form-input" id="instagramInput" placeholder="URL Instagram">
                    <input type="text" class="form-input" id="facebookInput" placeholder="URL Facebook" style="margin-top: 10px;">
                    <input type="text" class="form-input" id="tiktokInput" placeholder="URL TikTok" style="margin-top: 10px;">
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Direcci√≥n" data-pt="Endere√ßo">Direcci√≥n</label>
                    <input type="text" class="form-input" id="addressInput" placeholder="Santa Cruz de la Sierra, Bolivia" value="Santa Cruz de la Sierra, Bolivia">
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="deliveryTextLabel" data-es="Texto de Entrega (para WhatsApp)" data-pt="Texto de Entrega (para WhatsApp)">Texto de Entrega (para WhatsApp)</label>
                    <input type="text" class="form-input" id="deliveryTextInput" placeholder="A combinar" value="Calcular via WhatsApp">
                    <small style="color: var(--gray); display: block; margin-top: 5px;">
                        <span data-es="Este texto aparecer√° en el mensaje de WhatsApp para la entrega" 
                              data-pt="Este texto aparecer√° na mensagem do WhatsApp para a entrega">
                            Este texto aparecer√° en el mensaje de WhatsApp para la entrega
                        </span>
                    </small>
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="deliveryPriceLabel">Precio de Entrega (Bs)</label>
                    <input type="number" step="0.01" class="form-input" id="deliveryPriceInput" value="">
                    <small style="color: var(--gray); display: block; margin-top: 5px;">
                        <span data-es="Dejar vac√≠o para mostrar 'Calcular via WhatsApp'" 
                              data-pt="Deixar vazio para mostrar 'Calcular via WhatsApp'">
                            Dejar vac√≠o para mostrar 'Calcular via WhatsApp'
                        </span>
                    </small>
                </div>

                <!-- NOVO CAMPO: Frase abaixo das imagens hero -->
                <div class="form-group">
                    <label class="form-label" data-es="Frase Hero (debajo de las im√°genes)" data-pt="Frase Hero (abaixo das imagens)">Frase Hero (debajo de las im√°genes)</label>
                    <input type="text" class="form-input" id="heroPhraseInput" placeholder="Ej: Comida saludable entregada en 24h" value="Comida saludable entregada en 24h">
                    <small style="color: var(--gray); display: block; margin-top: 5px;">
                        <span data-es="Esta frase aparecer√° debajo de las dos fotos de marmitas en la p√°gina principal." 
                              data-pt="Esta frase aparecer√° abaixo das duas fotos de marmitas na p√°gina inicial.">
                            Esta frase aparecer√° debajo de las dos fotos de marmitas en la p√°gina principal.
                        </span>
                    </small>
                </div>
                
                <button class="btn btn-primary" onclick="saveStoreInfo()" id="saveStoreInfoBtn">
                    üíæ <span data-es="Guardar Informaci√≥n" data-pt="Salvar Informa√ß√£o">Guardar Informaci√≥n</span>
                </button>
            </div>
            
            <!-- Tab: Configuraci√≥n -->
            <div class="tab-content" id="settingsTab">
                <h3 data-es="Configuraci√≥n General" data-pt="Configura√ß√£o Geral">Configuraci√≥n General</h3>
                
                <div class="form-group">
                    <label class="form-label" data-es="Nombre del Negocio" data-pt="Nome do Neg√≥cio">Nombre del Negocio</label>
                    <input type="text" class="form-input" id="businessName" value="NutriBalance">
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="WhatsApp (Bolivia)" data-pt="WhatsApp (Bol√≠via)">WhatsApp (Bolivia)</label>
                    <input type="text" class="form-input" id="whatsappNumber" value="59177123456">
                </div>
                
                <div class="form-group">
                    <label class="form-label" data-es="Email de Contacto" data-pt="Email de Contato">Email de Contacto</label>
                    <input type="email" class="form-input" id="contactEmail" value="hola@nutribalance.com">
                </div>
                
                <button class="btn btn-primary" onclick="saveSettings()" id="saveSettingsBtn">
                    üíæ <span data-es="Guardar Configuraci√≥n" data-pt="Salvar Configura√ß√£o">Guardar Configuraci√≥n</span>
                </button>
                
                <div style="margin-top: 30px; padding: 20px; background: var(--light); border-radius: var(--radius);">
                    <h4>üìä <span data-es="Exportar/Importar Datos" data-pt="Exportar/Importar Dados">Exportar/Importar Datos</span></h4>
                    <button class="btn btn-secondary" onclick="exportData()">üì• <span data-es="Exportar Base de Datos" data-pt="Exportar Base de Dados">Exportar Base de Datos</span></button>
                    <button class="btn btn-secondary" onclick="importData()">üì§ <span data-es="Importar Base de Datos" data-pt="Importar Base de Dados">Importar Base de Datos</span></button>
                    <input type="file" id="importFile" style="display: none;" accept=".json">
                </div>
            </div>
        </div>
    </div>

    <!-- ===== JAVASCRIPT ===== -->
    <script>
        // Carregar dados.json automaticamente ao abrir a p√°gina
async function carregarDadosJsonAutomatico() {
  try {
    const response = await fetch('dados.json');
    if (!response.ok) {
      throw new Error('Erro ao carregar dados.json: ' + response.status);
    }
    const data = await response.json();

    // Abre o IndexedDB (ajuste o nome da fun√ß√£o se for diferente)
    const db = await new Promise((resolve, reject) => {
      const request = indexedDB.open('NutriBalanceDB', 1); // ajuste o nome do DB e vers√£o se necess√°rio
      request.onsuccess = () => resolve(request.result);
      request.onerror = () => reject(request.error);
    });

    const tx = db.transaction(['products', 'combos', 'clients', 'orders', 'users', 'settings'], 'readwrite');

    // Limpa e popula cada store com os dados do JSON
    const stores = {
      products: data.products || [],
      combos: data.combos || [],
      clients: data.clients || [],
      orders: data.orders || [],
      users: data.users || [],
      settings: data.settings ? [data.settings] : []  // settings pode ser array ou objeto √∫nico
    };

    for (const [storeName, items] of Object.entries(stores)) {
      const store = tx.objectStore(storeName);
      await store.clear();  // limpa dados antigos
      items.forEach(item => {
        if (item.id) store.put(item);  // usa put para upsert (atualiza se id existir)
        else store.add(item);  // ou add se n√£o tem id
      });
    }

    await tx.done;
    console.log('Dados de dados.json carregados com sucesso!');

    // Recarrega a interface (chame suas fun√ß√µes de render)
    if (typeof loadMenu === 'function') loadMenu();
    if (typeof renderProducts === 'function') renderProducts();
    if (typeof updateCart === 'function') updateCart();
    if (typeof loadClients === 'function') loadClients();
    if (typeof initApp === 'function') initApp();  // ou refreshAll(), loadAllData(), etc.
    location.reload();  // recarrega a p√°gina para mostrar tudo atualizado (opcional, mas eficaz)

  } catch (error) {
    console.error('Falha ao carregar dados.json:', error);
    // Opcional: alerta ou fallback para dados vazios/hardcoded
    alert('N√£o foi poss√≠vel carregar os dados atualizados. Verifique o console.');
  }
}

// Executa imediatamente ao carregar a p√°gina
carregarDadosJsonAutomatico();
        
        // ===== CONFIGURA√á√ÉO INICIAL =====
        let currentLanguage = 'es';
        let cart = [];
        let currentUser = null;
        let db = null;
        
        // Constantes para o IndexedDB
        const DB_NAME = 'NutriBalanceDB';
        const DB_VERSION = 3;
        const STORES = {
            SETTINGS: 'settings',
            PRODUCTS: 'products',
            COMBOS: 'combos',
            CLIENTS: 'clients',
            ORDERS: 'orders',
            CART: 'cart',
            USERS: 'users'
        };

        // ===== FRASES DIN√ÇMICAS DE CADASTRO =====
        const registrationPhrases = {
            es: [
                "Con solo 3 minutos preparas tu comida y comes saludable",
                "Comer saludable nunca fue tan f√°cil",
                "Reg√≠strate y mantente al tanto de novedades y promociones.",
                "No te preocupes, nosotros preparamos con cari√±o para ti.",
                "No necesitas contar calor√≠as, nosotros las contamos por ti.",
                "Tu versi√≥n fitness est√° a un microondas de distancia.",
                "Cuida de tus negocios, tu dieta la cuidamos nosotros.",
                "No te preocupes, con nosotros el lunes comienza cuando quieras, solo calentar y comer.",
                "¬øTienes hambre y sin tiempo? Con nosotros no sales de la dieta.",
                "Del congelador a tu mesa en minutos y sin conservantes, ¬°solo resultados!"
            ],
            pt: [
                "Com apenas 3 min voc√™ prepara sua comida e come saud√°vel",
                "Comer saud√°vel nunca foi t√£o f√°cil",
                "Cadastre-se e fique por dentro das novidades e promo√ß√µes.",
                "N√£o se preocupe, A gente prepara com carinho pra voc√™.",
                "N√£o precisa contar calorias, A gente conta pra voc√™.",
                "Sua vers√£o fitness est√° a um Micro-ondas de voc√™.",
                "Cuida dos seus neg√≥cios, sua dieta a gente cuida pra voc√™.",
                "N√£o se preocupe com a gente a segunda-feira come√ßa quando voc√™ quiser, s√≥ esquentar e comer.",
                "Est√° com Fome e sem tempo? com a gente voc√™ n√£o sai da dieta.",
                "Do congelador a sua mesa em minutos e sem conservantes, apenas resultados!"
            ]
        };

        let currentPhraseIndex = 0;

        function showDynamicPhrase() {
            if (!currentUser) {
                const phrases = registrationPhrases[currentLanguage];
                const phraseElement = document.getElementById('dynamicPhrase');
                
                if (phraseElement && phrases && phrases.length > 0) {
                    phraseElement.textContent = phrases[currentPhraseIndex];
                    currentPhraseIndex = (currentPhraseIndex + 1) % phrases.length;
                }
            }
        }

        // ===== INDEXEDDB FUNCTIONS =====
        function initDatabase() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = (event) => {
                    console.error('‚ùå Erro ao abrir banco de dados:', event.target.error);
                    updateDBStatus('‚ùå Banco de dados offline - usando localStorage');
                    
                    initLocalStorageFallback();
                    resolve(false);
                };
                
                request.onsuccess = (event) => {
                    db = event.target.result;
                    console.log('‚úÖ Banco de dados IndexedDB aberto com sucesso');
                    updateDBStatus('‚úÖ Banco de dados conectado');
                    
                    setTimeout(() => {
                        checkInitialData().then(() => {
                            loadInitialData();
                            resolve(true);
                        }).catch(error => {
                            console.error('‚ùå Erro ao verificar dados iniciais:', error);
                            initLocalStorageFallback();
                            loadInitialData();
                            resolve(true);
                        });
                    }, 100);
                };
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    console.log('üîÑ Atualizando banco de dados para vers√£o:', DB_VERSION);
                    
                    if (!db.objectStoreNames.contains(STORES.SETTINGS)) {
                        const settingsStore = db.createObjectStore(STORES.SETTINGS, { keyPath: 'id' });
                        settingsStore.createIndex('by_key', 'key', { unique: true });
                    }
                    
                    if (!db.objectStoreNames.contains(STORES.PRODUCTS)) {
                        const productsStore = db.createObjectStore(STORES.PRODUCTS, { keyPath: 'id' });
                        productsStore.createIndex('by_type', 'type', { unique: false });
                        productsStore.createIndex('by_category', 'category', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains(STORES.COMBOS)) {
                        const combosStore = db.createObjectStore(STORES.COMBOS, { keyPath: 'id' });
                        combosStore.createIndex('by_type', 'type', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains(STORES.CLIENTS)) {
                        const clientsStore = db.createObjectStore(STORES.CLIENTS, { keyPath: 'id', autoIncrement: true });
                        clientsStore.createIndex('by_email', 'email', { unique: true });
                        clientsStore.createIndex('by_phone', 'phone', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains(STORES.ORDERS)) {
                        const ordersStore = db.createObjectStore(STORES.ORDERS, { keyPath: 'id', autoIncrement: true });
                        ordersStore.createIndex('by_client', 'clientId', { unique: false });
                        ordersStore.createIndex('by_date', 'date', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains(STORES.CART)) {
                        const cartStore = db.createObjectStore(STORES.CART, { keyPath: 'id' });
                        cartStore.createIndex('by_type', 'type', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains(STORES.USERS)) {
                        const usersStore = db.createObjectStore(STORES.USERS, { keyPath: 'id' });
                        usersStore.createIndex('by_email', 'email', { unique: true });
                    }
                    
                    console.log('üìÅ Estrutura do banco de dados criada/atualizada');
                };
            });
        }

        function initLocalStorageFallback() {
            console.log('üîÑ Usando localStorage como fallback');
            
            const savedCart = localStorage.getItem('nutribalance_cart');
            if (savedCart) {
                try {
                    cart = JSON.parse(savedCart);
                    updateCartUI();
                } catch (e) {
                    console.error('‚ùå Erro ao carregar carrinho do localStorage:', e);
                }
            }
            
            const savedUser = localStorage.getItem('nutribalance_user');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    updateUserInterface();
                } catch (e) {
                    console.error('‚ùå Erro ao carregar usu√°rio do localStorage:', e);
                    localStorage.removeItem('nutribalance_user');
                }
            }
        }

        function updateDBStatus(status) {
            const dbStatus = document.getElementById('dbStatus');
            if (dbStatus) {
                dbStatus.textContent = status;
            }
        }

        // ===== OPERA√á√ïES DO BANCO DE DADOS =====
        function dbGetAll(storeName) {
            return new Promise((resolve, reject) => {
                if (!db) {
                    const key = `nutribalance_${storeName}`;
                    const existing = JSON.parse(localStorage.getItem(key) || '[]');
                    resolve(existing);
                    return;
                }
                
                try {
                    const transaction = db.transaction([storeName], 'readonly');
                    const store = transaction.objectStore(storeName);
                    const request = store.getAll();
                    
                    request.onsuccess = () => resolve(request.result || []);
                    request.onerror = () => {
                        console.error(`‚ùå Erro ao buscar dados de ${storeName}:`, request.error);
                        const key = `nutribalance_${storeName}`;
                        const existing = JSON.parse(localStorage.getItem(key) || '[]');
                        resolve(existing);
                    };
                } catch (error) {
                    console.error(`‚ùå Erro na transa√ß√£o com ${storeName}:`, error);
                    resolve([]);
                }
            });
        }

        function dbAdd(storeName, data) {
            return new Promise((resolve, reject) => {
                if (!db) {
                    const key = `nutribalance_${storeName}`;
                    const existing = JSON.parse(localStorage.getItem(key) || '[]');
                    existing.push(data);
                    localStorage.setItem(key, JSON.stringify(existing));
                    resolve(data);
                    return;
                }
                
                try {
                    const transaction = db.transaction([storeName], 'readwrite');
                    const store = transaction.objectStore(storeName);
                    const request = store.add(data);
                    
                    request.onsuccess = () => resolve({ ...data, id: request.result });
                    request.onerror = () => {
                        console.error(`‚ùå Erro ao adicionar em ${storeName}:`, request.error);
                        reject(request.error);
                    };
                } catch (error) {
                    console.error(`‚ùå Erro na transa√ß√£o com ${storeName}:`, error);
                    reject(error);
                }
            });
        }

        function dbPut(storeName, data) {
            return new Promise((resolve, reject) => {
                if (!db) {
                    const key = `nutribalance_${storeName}`;
                    const existing = JSON.parse(localStorage.getItem(key) || '[]');
                    const index = existing.findIndex(item => item.id === data.id);
                    if (index !== -1) {
                        existing[index] = data;
                    } else {
                        existing.push(data);
                    }
                    localStorage.setItem(key, JSON.stringify(existing));
                    resolve(data);
                    return;
                }
                
                try {
                    const transaction = db.transaction([storeName], 'readwrite');
                    const store = transaction.objectStore(storeName);
                    const request = store.put(data);
                    
                    request.onsuccess = () => resolve(data);
                    request.onerror = () => {
                        console.error(`‚ùå Erro ao atualizar em ${storeName}:`, request.error);
                        reject(request.error);
                    };
                } catch (error) {
                    console.error(`‚ùå Erro na transa√ß√£o com ${storeName}:`, error);
                    reject(error);
                }
            });
        }

        function dbDelete(storeName, id) {
            return new Promise((resolve, reject) => {
                if (!db) {
                    const key = `nutribalance_${storeName}`;
                    const existing = JSON.parse(localStorage.getItem(key) || '[]');
                    const filtered = existing.filter(item => item.id !== id);
                    localStorage.setItem(key, JSON.stringify(filtered));
                    resolve(true);
                    return;
                }
                
                try {
                    const transaction = db.transaction([storeName], 'readwrite');
                    const store = transaction.objectStore(storeName);
                    const request = store.delete(id);
                    
                    request.onsuccess = () => resolve(true);
                    request.onerror = () => {
                        console.error(`‚ùå Erro ao deletar de ${storeName}:`, request.error);
                        reject(request.error);
                    };
                } catch (error) {
                    console.error(`‚ùå Erro na transa√ß√£o com ${storeName}:`, error);
                    reject(error);
                }
            });
        }

        function dbGet(storeName, id) {
            return new Promise((resolve, reject) => {
                if (!db) {
                    const key = `nutribalance_${storeName}`;
                    const existing = JSON.parse(localStorage.getItem(key) || '[]');
                    const item = existing.find(item => item.id === id);
                    resolve(item || null);
                    return;
                }
                
                try {
                    const transaction = db.transaction([storeName], 'readonly');
                    const store = transaction.objectStore(storeName);
                    const request = store.get(id);
                    
                    request.onsuccess = () => resolve(request.result || null);
                    request.onerror = () => {
                        console.error(`‚ùå Erro ao buscar de ${storeName}:`, request.error);
                        resolve(null);
                    };
                } catch (error) {
                    console.error(`‚ùå Erro na transa√ß√£o com ${storeName}:`, error);
                    resolve(null);
                }
            });
        }

        function dbGetByIndex(storeName, indexName, value) {
            return new Promise((resolve, reject) => {
                if (!db) {
                    const key = `nutribalance_${storeName}`;
                    const existing = JSON.parse(localStorage.getItem(key) || '[]');
                    const item = existing.find(item => item[indexName] === value);
                    resolve(item || null);
                    return;
                }
                
                try {
                    const transaction = db.transaction([storeName], 'readonly');
                    const store = transaction.objectStore(storeName);
                    const index = store.index(indexName);
                    const request = index.get(value);
                    
                    request.onsuccess = () => resolve(request.result || null);
                    request.onerror = () => {
                        console.error(`‚ùå Erro ao buscar por √≠ndice em ${storeName}:`, request.error);
                        resolve(null);
                    };
                } catch (error) {
                    console.error(`‚ùå Erro na transa√ß√£o com ${storeName}:`, error);
                    resolve(null);
                }
            });
        }

        // ===== DADOS INICIAIS =====
        async function checkInitialData() {
            try {
                const products = await dbGetAll(STORES.PRODUCTS);
                const combos = await dbGetAll(STORES.COMBOS);
                
                if (products.length === 0) {
                    await addInitialProducts();
                }
                
                if (combos.length === 0) {
                    await addInitialCombos();
                }
                
                const settings = await dbGetAll(STORES.SETTINGS);
                if (settings.length === 0) {
                    await addDefaultSettings();
                }
                
                await ensureAdminExists();
                
            } catch (error) {
                console.error('‚ùå Erro ao verificar dados iniciais:', error);
            }
        }

        async function addInitialProducts() {
            const initialProducts = [
                {
                    id: 1,
                    type: 'product',
                    nameEs: 'Carne con Boniato',
                    namePt: 'Carne com Batata Doce',
                    descriptionEs: 'Filete de carne con pur√© de boniato y jud√≠as verdes',
                    descriptionPt: 'Fil√© de carne com pur√™ de batata doce e vagens',
                    price: 26.90,
                    calories: 450,
                    protein: 40,
                    carbs: 35,
                    fat: 15,
                    imageUrl: 'https://i.imgur.com/8k7qQjL.jpeg',
                    category: 'carne'
                },
                {
                    id: 2,
                    type: 'product',
                    nameEs: 'Pollo a la Parrilla',
                    namePt: 'Frango Grelhado',
                    descriptionEs: 'Pechuga de pollo a la parrilla con arroz integral',
                    descriptionPt: 'Peito de frango grelhado com arroz integral',
                    price: 24.90,
                    calories: 420,
                    protein: 35,
                    carbs: 45,
                    fat: 8,
                    imageUrl: 'https://i.imgur.com/3yqWvzD.jpeg',
                    category: 'pollo'
                }
            ];
            
            for (const product of initialProducts) {
                await dbPut(STORES.PRODUCTS, product);
            }
            
            console.log('‚úÖ Produtos iniciais adicionados com as fotos atualizadas');
        }

        async function addInitialCombos() {
            const initialCombos = [
                {
                    id: 101,
                    type: 'combo',
                    nameEs: 'Combo Semana Fit',
                    namePt: 'Combo Semana Fit',
                    descriptionEs: '7 bandejas para toda la semana. ¬°Elige tus favoritas!',
                    descriptionPt: '7 marmitas para a semana toda. Escolha suas favoritas!',
                    price: 149.90,
                    calories: null,
                    protein: null,
                    carbs: null,
                    fat: null,
                    imageUrl: 'https://i.imgur.com/8k7qQjL.jpeg',
                    category: 'combo'
                }
            ];
            
            for (const combo of initialCombos) {
                await dbPut(STORES.COMBOS, combo);
            }
            
            console.log('‚úÖ Combos iniciais adicionados');
        }

        async function addDefaultSettings() {
            const defaultSettings = {
                id: 'app_settings',
                businessName: 'NutriBalance',
                whatsappNumber: '59177123456',
                contactEmail: 'hola@nutribalance.com',
                deliveryPrice: null,
                deliveryText: 'Calcular via WhatsApp',
                currencySymbol: 'Bs',
                heroImages: {
                    carne: 'https://i.imgur.com/8k7qQjL.jpeg',
                    frango: 'https://i.imgur.com/3yqWvzD.jpeg',
                    carneText: 'Carne Fitness',
                    frangoText: 'Pollo Fitness'
                },
                heroPhrase: {
                    es: 'Comida saludable entregada en 24h',
                    pt: 'Comida saud√°vel entregue em 24h'
                },
                qrCode: {
                    image: '',
                    pixCode: ''
                },
                storeInfo: {
                    footerDescription: 'Tu equilibrio nutricional entregado en casa',
                    instagram: '',
                    facebook: '',
                    tiktok: '',
                    address: 'Santa Cruz de la Sierra, Bolivia'
                }
            };
            
            await dbPut(STORES.SETTINGS, defaultSettings);
            console.log('‚úÖ Configura√ß√µes padr√£o adicionadas com as fotos do Imgur');
        }

        async function ensureAdminExists() {
            try {
                let adminUser = await dbGet(STORES.USERS, 'admin');
                
                if (!adminUser) {
                    adminUser = {
                        id: 'admin',
                        type: 'admin',
                        name: 'Administrador',
                        email: 'admin@nutribalance.com',
                        created: new Date().toISOString()
                    };
                    
                    await dbPut(STORES.USERS, adminUser);
                    console.log('‚úÖ Usu√°rio admin criado');
                }
                
                localStorage.setItem('nutribalance_admin', JSON.stringify(adminUser));
                
            } catch (error) {
                console.error('‚ùå Erro ao verificar admin:', error);
            }
        }

        // ===== CARREGAMENTO INICIAL =====
        async function loadInitialData() {
            try {
                console.log('üîÑ Carregando dados iniciais...');
                
                const cartItems = await dbGetAll(STORES.CART);
                cart = cartItems;
                updateCartUI();
                console.log('üõí Carrinho carregado:', cart.length, 'itens');
                
                let user = null;
                
                const savedUser = localStorage.getItem('nutribalance_user');
                if (savedUser) {
                    try {
                        user = JSON.parse(savedUser);
                        console.log('üë§ Usu√°rio carregado do localStorage:', user);
                    } catch (e) {
                        console.error('‚ùå Erro ao parsear usu√°rio do localStorage:', e);
                        localStorage.removeItem('nutribalance_user');
                    }
                }
                
                if (!user) {
                    const currentUserId = localStorage.getItem('currentUserId');
                    if (currentUserId) {
                        user = await dbGet(STORES.USERS, currentUserId);
                        console.log('üë§ Usu√°rio carregado do IndexedDB pelo ID:', user);
                        
                        if (user) {
                            localStorage.setItem('nutribalance_user', JSON.stringify(user));
                        }
                    }
                }
                
                if (user) {
                    currentUser = user;
                    updateUserInterface();
                    console.log('‚úÖ Usu√°rio definido:', currentUser.name, '(', currentUser.type, ')');
                } else {
                    console.log('‚ÑπÔ∏è Nenhum usu√°rio logado');
                }
                
                await renderProducts();
                await renderCombos();
                
                await loadHeroImagesFromSettings();
                await updateStoreInfoInFooter();
                await loadHeroPhraseFromSettings();
                
                showDynamicPhrase();
                setInterval(showDynamicPhrase, 10000);
                
                updateAllLanguageElements();
                
                console.log('‚úÖ Dados iniciais carregados com sucesso');
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados iniciais:', error);
            }
        }

        // Fun√ß√£o: Carregar frase hero
        async function loadHeroPhraseFromSettings() {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                const container = document.getElementById('heroFooterPhraseContainer');
                if (container && settings && settings.heroPhrase) {
                    const phrase = settings.heroPhrase[currentLanguage] || settings.heroPhrase.es || 'Comida saludable entregada en 24h';
                    container.textContent = phrase;
                    container.style.display = phrase ? 'block' : 'none';
                } else if (container) {
                    container.textContent = 'Comida saludable entregada en 24h';
                    container.style.display = 'block';
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar frase hero:', error);
            }
        }

        // ===== IDIOMA E MOEDA =====
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            document.querySelectorAll('.flag').forEach(flag => {
                flag.classList.remove('active');
            });
            const flagClass = lang === 'es' ? 'bo' : 'br';
            document.querySelector(`.flag-${flagClass}`).classList.add('active');
            
            updateCurrencySymbol(lang);
            
            updateAllLanguageElements();
            
            renderProducts();
            renderCombos();
            
            loadHeroPhraseFromSettings();
            
            const deliveryLocation = document.getElementById('deliveryLocation');
            if (deliveryLocation) {
                deliveryLocation.placeholder = currentLanguage === 'es' 
                    ? 'Ingresa tu direcci√≥n completa (calle, n√∫mero, barrio, ciudad)...' 
                    : 'Insira seu endere√ßo completo (rua, n√∫mero, bairro, cidade)...';
            }
            
            showDynamicPhrase();
        }

        async function updateCurrencySymbol(lang) {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (settings) {
                    settings.currencySymbol = lang === 'es' ? 'Bs' : 'R$';
                    await dbPut(STORES.SETTINGS, settings);
                }
            } catch (error) {
                console.error('‚ùå Erro ao atualizar s√≠mbolo de moeda:', error);
            }
        }

        function updateAllLanguageElements() {
            document.querySelectorAll('[data-es], [data-pt]').forEach(element => {
                const text = element.getAttribute(`data-${currentLanguage}`);
                if (text) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA' || element.tagName === 'SELECT') {
                        if (element.placeholder) {
                            element.placeholder = text;
                        }
                    } else if (element.tagName === 'IMG') {
                        element.alt = text;
                    } else {
                        element.textContent = text;
                    }
                }
            });
        }

        // ===== NAVEGA√á√ÉO =====
        function goToHome() {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('cartPage').style.display = 'none';
            document.getElementById('checkoutSection').style.display = 'none';
            document.getElementById('clientsSection').style.display = 'none';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function goToSection(sectionId) {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('cartPage').style.display = 'none';
            document.getElementById('checkoutSection').style.display = 'none';
            document.getElementById('clientsSection').style.display = 'none';
            
            const section = document.getElementById(sectionId);
            if (section) {
                const headerHeight = document.getElementById('header').offsetHeight;
                window.scrollTo({
                    top: section.offsetTop - headerHeight,
                    behavior: 'smooth'
                });
            }
        }

        // ===== RENDERIZA√á√ÉO DE PRODUTOS =====
        async function renderProducts() {
            try {
                const products = await dbGetAll(STORES.PRODUCTS);
                const container = document.getElementById('productsGrid');
                
                if (!container) return;
                
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                const currencySymbol = settings ? settings.currencySymbol : 'Bs';
                
                container.innerHTML = products.map(product => `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${product.imageUrl}" alt="${currentLanguage === 'es' ? product.nameEs : product.namePt}" class="product-img">
                        </div>
                        <div class="product-info">
                            <h3 class="product-title">${currentLanguage === 'es' ? product.nameEs : product.namePt}</h3>
                            <p class="product-description">${currentLanguage === 'es' ? product.descriptionEs : product.descriptionPt}</p>
                            
                            ${product.calories ? `
                                <div class="product-macros">
                                    <div class="macro">
                                        <span class="macro-value">${product.calories}</span>
                                        <span class="macro-label">kcal</span>
                                    </div>
                                    <div class="macro">
                                        <span class="macro-value">${product.protein}g</span>
                                        <span class="macro-label">${currentLanguage === 'es' ? 'Prote√≠na' : 'Prote√≠na'}</span>
                                    </div>
                                    <div class="macro">
                                        <span class="macro-value">${product.carbs}g</span>
                                        <span class="macro-label">${currentLanguage === 'es' ? 'Carbs' : 'Carboidratos'}</span>
                                    </div>
                                </div>
                            ` : ''}
                            
                            <div class="product-footer">
                                <div class="product-price">${currencySymbol} ${product.price.toFixed(2)}</div>
                                <button class="add-to-cart" onclick="addToCart(${product.id}, '${currentLanguage === 'es' ? product.nameEs : product.namePt}', ${product.price}, 'product', '${product.imageUrl}')">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                updateAllLanguageElements();
            } catch (error) {
                console.error('‚ùå Erro ao renderizar produtos:', error);
            }
        }

        async function renderCombos() {
            try {
                const combos = await dbGetAll(STORES.COMBOS);
                const container = document.getElementById('combosGrid');
                
                if (!container) return;
                
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                const currencySymbol = settings ? settings.currencySymbol : 'Bs';
                
                container.innerHTML = combos.map(combo => `
                    <div class="product-card" style="border: 3px solid var(--secondary);">
                        <div class="product-image">
                            <img src="${combo.imageUrl}" alt="${currentLanguage === 'es' ? combo.nameEs : combo.namePt}" class="product-img">
                        </div>
                        <div class="product-info">
                            <h3 class="product-title">${currentLanguage === 'es' ? combo.nameEs : combo.namePt}</h3>
                            <p class="product-description">${currentLanguage === 'es' ? combo.descriptionEs : combo.descriptionPt}</p>
                            
                            <div class="product-footer">
                                <div class="product-price">${currencySymbol} ${combo.price.toFixed(2)}</div>
                                <button class="add-to-cart" onclick="addToCart(${combo.id}, '${currentLanguage === 'es' ? combo.nameEs : combo.namePt}', ${combo.price}, 'combo', '${combo.imageUrl}')">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                updateAllLanguageElements();
            } catch (error) {
                console.error('‚ùå Erro ao renderizar combos:', error);
            }
        }

        // ===== SISTEMA DE LOGIN E REGISTRO =====
        function openLoginModal() {
            closeRegisterModal();
            document.getElementById('loginModal').style.display = 'flex';
            updateAllLanguageElements();
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('clientError').style.display = 'none';
            document.getElementById('adminError').style.display = 'none';
        }

        function openRegisterModal() {
            closeLoginModal();
            document.getElementById('registerModal').style.display = 'flex';
            updateAllLanguageElements();
        }

        function closeRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
            document.getElementById('registerError').style.display = 'none';
        }

        function openLoginModalFromRegister() {
            closeRegisterModal();
            openLoginModal();
        }

        function openLoginTab(tab) {
            document.querySelectorAll('.login-form').forEach(form => {
                form.classList.remove('active');
            });
            document.querySelectorAll('.login-tab').forEach(tabBtn => {
                tabBtn.classList.remove('active');
            });
            
            document.getElementById(tab + 'Login').classList.add('active');
            event.target.classList.add('active');
        }

        function openRegisterTab(tab) {
            // Para futuras expans√µes
        }

        async function registerClient(event) {
            event.preventDefault();
            event.stopPropagation();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const phone = document.getElementById('registerPhone').value;
            const birthday = document.getElementById('registerBirthday').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            if (!name || !email || !phone || !birthday || !password || !confirmPassword) {
                document.getElementById('registerError').textContent = currentLanguage === 'es' 
                    ? 'Por favor, complete todos los campos' 
                    : 'Por favor, preencha todos os campos';
                document.getElementById('registerError').style.display = 'block';
                return;
            }
            
            if (password !== confirmPassword) {
                document.getElementById('registerError').textContent = currentLanguage === 'es' 
                    ? 'Las contrase√±as no coinciden' 
                    : 'As senhas n√£o coincidem';
                document.getElementById('registerError').style.display = 'block';
                return;
            }
            
            if (password.length < 6) {
                document.getElementById('registerError').textContent = currentLanguage === 'es' 
                    ? 'La contrase√±a debe tener al menos 6 caracteres' 
                    : 'A senha deve ter pelo menos 6 caracteres';
                document.getElementById('registerError').style.display = 'block';
                return;
            }
            
            try {
                const existingClient = await dbGetByIndex(STORES.CLIENTS, 'by_email', email);
                if (existingClient) {
                    document.getElementById('registerError').textContent = currentLanguage === 'es' 
                        ? 'Este email ya est√° registrado' 
                        : 'Este email j√° est√° registrado';
                    document.getElementById('registerError').style.display = 'block';
                    return;
                }
                
                const newClient = {
                    name: name,
                    email: email,
                    phone: phone,
                    birthday: birthday,
                    password: password,
                    registrationDate: new Date().toISOString(),
                    totalOrders: 0,
                    totalSpent: 0,
                    lastOrderDate: null
                };
                
                const savedClient = await dbAdd(STORES.CLIENTS, newClient);
                
                const newUser = {
                    id: savedClient.id,
                    type: 'client',
                    name: name,
                    email: email,
                    clientId: savedClient.id
                };
                
                await dbPut(STORES.USERS, newUser);
                
                localStorage.setItem('currentUserId', savedClient.id.toString());
                localStorage.setItem('nutribalance_user', JSON.stringify(newUser));
                
                currentUser = newUser;
                updateUserInterface();
                closeRegisterModal();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚úÖ ¬°Cuenta creada con √©xito! Bienvenido a NutriBalance' 
                    : '‚úÖ Conta criada com sucesso! Bem-vindo ao NutriBalance');
            } catch (error) {
                console.error('‚ùå Erro ao registrar cliente:', error);
                document.getElementById('registerError').textContent = currentLanguage === 'es' 
                    ? 'Error al crear la cuenta. Intente nuevamente.' 
                    : 'Erro ao criar a conta. Tente novamente.';
                document.getElementById('registerError').style.display = 'block';
            }
        }

        async function loginClient() {
            const email = document.getElementById('clientEmail').value;
            const password = document.getElementById('clientPassword').value;
            
            if (!email || !password) {
                document.getElementById('clientError').textContent = currentLanguage === 'es' ? 'Por favor, complete todos los campos' : 'Por favor, preencha todos os campos';
                document.getElementById('clientError').style.display = 'block';
                return;
            }
            
            try {
                const client = await dbGetByIndex(STORES.CLIENTS, 'by_email', email);
                
                if (client && client.password === password) {
                    const user = {
                        id: client.id,
                        type: 'client',
                        name: client.name,
                        email: client.email,
                        clientId: client.id
                    };
                    
                    await dbPut(STORES.USERS, user);
                    
                    localStorage.setItem('currentUserId', client.id.toString());
                    localStorage.setItem('nutribalance_user', JSON.stringify(user));
                    
                    currentUser = user;
                    updateUserInterface();
                    closeLoginModal();
                    
                    showNotification(currentLanguage === 'es' ? `‚úÖ ¬°Bienvenido de nuevo, ${client.name}!` : `‚úÖ Bem-vindo de volta, ${client.name}!`);
                } else {
                    document.getElementById('clientError').textContent = currentLanguage === 'es' ? 'Email o contrase√±a incorrectos' : 'Email ou senha incorretos';
                    document.getElementById('clientError').style.display = 'block';
                }
            } catch (error) {
                console.error('‚ùå Erro ao fazer login:', error);
                document.getElementById('clientError').textContent = currentLanguage === 'es' ? 'Error al iniciar sesi√≥n' : 'Erro ao fazer login';
                document.getElementById('clientError').style.display = 'block';
            }
        }

        async function loginAdmin() {
            const user = document.getElementById('adminUser').value;
            const password = document.getElementById('adminPassword').value;
            
            const adminCredentials = {
                user: '1',
                password: '1'
            };
            
            if (user === adminCredentials.user && password === adminCredentials.password) {
                try {
                    let adminUser = await dbGet(STORES.USERS, 'admin');
                    
                    if (!adminUser) {
                        adminUser = {
                            id: 'admin',
                            type: 'admin',
                            name: 'Administrador',
                            email: 'admin@nutribalance.com',
                            created: new Date().toISOString()
                        };
                        await dbPut(STORES.USERS, adminUser);
                    }
                    
                    localStorage.setItem('currentUserId', 'admin');
                    localStorage.setItem('nutribalance_user', JSON.stringify(adminUser));
                    
                    currentUser = adminUser;
                    updateUserInterface();
                    closeLoginModal();
                    
                    showNotification(currentLanguage === 'es' ? '‚úÖ ¬°Bienvenido, Administrador!' : '‚úÖ Bem-vindo, Administrador!');
                } catch (error) {
                    console.error('‚ùå Erro ao fazer login do admin:', error);
                    document.getElementById('adminError').textContent = currentLanguage === 'es' ? 'Error al iniciar sesi√≥n' : 'Erro ao fazer login';
                    document.getElementById('adminError').style.display = 'block';
                }
            } else {
                document.getElementById('adminError').textContent = currentLanguage === 'es' ? 'Usuario o contrase√±a incorrectos' : 'Usu√°rio ou senha incorretos';
                document.getElementById('adminError').style.display = 'block';
            }
        }

        function openLogoutModal() {
            document.getElementById('logoutModal').style.display = 'flex';
            document.getElementById('logoutTitle').textContent = currentLanguage === 'es' ? 'Cerrar Sesi√≥n' : 'Sair';
            document.getElementById('logoutMessage').textContent = currentLanguage === 'es' 
                ? `¬øEst√°s seguro de que quieres cerrar sesi√≥n, ${currentUser?.name || 'Usuario'}?`
                : `Tem certeza que deseja sair, ${currentUser?.name || 'Usu√°rio'}?`;
            updateAllLanguageElements();
        }

        function closeLogoutModal() {
            document.getElementById('logoutModal').style.display = 'none';
        }

        async function logout() {
            currentUser = null;
            
            localStorage.removeItem('currentUserId');
            localStorage.removeItem('nutribalance_user');
            
            updateUserInterface();
            closeLogoutModal();
            
            showNotification(currentLanguage === 'es' ? 'üëã ¬°Hasta luego!' : 'üëã At√© logo!');
        }

        function updateUserInterface() {
            const userButtons = document.getElementById('userButtons');
            
            if (!userButtons) {
                console.warn('‚ö†Ô∏è Elemento userButtons n√£o encontrado');
                return;
            }
            
            const phraseContainer = document.getElementById('dynamicPhraseContainer');
            if (phraseContainer) {
                if (currentUser) {
                    phraseContainer.style.display = 'none';
                } else {
                    phraseContainer.style.display = 'block';
                }
            }
            
            if (currentUser) {
                console.log('üë§ Atualizando interface para usu√°rio:', currentUser.name);
                
                if (currentUser.type === 'admin') {
                    userButtons.innerHTML = `
                        <button class="login-btn" onclick="openAdmin()">
                            ‚öôÔ∏è <span data-es="Admin" data-pt="Admin">Admin</span>
                        </button>
                        <button class="logout-btn" onclick="openLogoutModal()">
                            üëã ${currentUser.name}
                        </button>
                    `;
                } else {
                    userButtons.innerHTML = `
                        <button class="login-btn" onclick="openLogoutModal()">
                            üë§ ${currentUser.name}
                        </button>
                    `;
                }
            } else {
                console.log('üë§ Nenhum usu√°rio logado, mostrando bot√£o de login');
                userButtons.innerHTML = `
                    <button class="login-btn" onclick="openLoginModal()">
                        üë§ <span data-es="Iniciar Sesi√≥n" data-pt="Entrar">Iniciar Sesi√≥n</span>
                    </button>
                `;
            }
            
            updateAllLanguageElements();
        }

        // ===== CARRINHO E CHECKOUT =====
        async function addToCart(id, name, price, type, imageUrl) {
            const existingItem = cart.find(item => item.id === id && item.type === type);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: id,
                    name: name,
                    price: price,
                    type: type,
                    quantity: 1,
                    imageUrl: imageUrl || ''
                });
            }
            
            try {
                await saveCartToDB();
            } catch (error) {
                console.error('‚ùå Erro ao salvar carrinho no banco:', error);
                localStorage.setItem('nutribalance_cart', JSON.stringify(cart));
            }
            
            updateCartUI();
            showNotification(`‚úÖ ${name} ${currentLanguage === 'es' ? 'a√±adido al carrito' : 'adicionado ao carrinho'}`);
            
            const button = event.target.closest('button');
            if (button) {
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i>';
                button.style.background = 'var(--primary-dark)';
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.style.background = '';
                }, 1000);
            }
        }

        async function saveCartToDB() {
            if (!db) {
                localStorage.setItem('nutribalance_cart', JSON.stringify(cart));
                return;
            }
            
            try {
                const transaction = db.transaction([STORES.CART], 'readwrite');
                const store = transaction.objectStore(STORES.CART);
                
                await store.clear();
                
                for (const item of cart) {
                    await store.put(item);
                }
            } catch (error) {
                console.error('‚ùå Erro ao salvar carrinho:', error);
                localStorage.setItem('nutribalance_cart', JSON.stringify(cart));
            }
        }

        function updateCartUI() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCount = document.getElementById('cartCount');
            if (cartCount) {
                cartCount.textContent = totalItems;
            }
        }

        function openCartPage() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('cartPage').style.display = 'block';
            document.getElementById('checkoutSection').style.display = 'none';
            document.getElementById('clientsSection').style.display = 'none';
            updateCartPage();
        }

        async function updateCartPage() {
            const container = document.getElementById('cartPageItems');
            const subtotalElement = document.getElementById('cartPageSubtotal');
            const deliveryElement = document.getElementById('cartPageDelivery');
            const totalElement = document.getElementById('cartPageTotal');
            
            let settings = {};
            try {
                settings = await dbGet(STORES.SETTINGS, 'app_settings') || {};
            } catch (error) {
                console.error('‚ùå Erro ao obter configura√ß√µes:', error);
            }
            
            const currencySymbol = settings.currencySymbol || 'Bs';
            const deliveryPrice = settings.deliveryPrice || null;
            const deliveryText = settings.deliveryText || 'Calcular via WhatsApp';
            
            if (cart.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: var(--gray);">
                        <div style="font-size: 60px; margin-bottom: 20px;">üõí</div>
                        <p>${currentLanguage === 'es' ? 'Tu carrito est√° vac√≠o' : 'Seu carrinho est√° vazio'}</p>
                        <button onclick="goToSection('cardapio')" style="margin-top: 20px; padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 5px; cursor: pointer;">
                            ${currentLanguage === 'es' ? 'Ver Men√∫' : 'Ver Card√°pio'}
                        </button>
                    </div>
                `;
                if (subtotalElement) subtotalElement.textContent = `${currencySymbol} 0,00`;
                
                if (deliveryElement) {
                    if (deliveryPrice) {
                        deliveryElement.textContent = `${currencySymbol} ${deliveryPrice.toFixed(2)}`;
                    } else {
                        deliveryElement.textContent = deliveryText;
                    }
                }
                
                const subtotal = 0;
                const delivery = deliveryPrice || 0;
                if (totalElement) totalElement.textContent = `${currencySymbol} ${(subtotal + delivery).toFixed(2)}`;
                return;
            }
            
            let subtotal = 0;
            let itemsHTML = '';
            
            for (let i = 0; i < cart.length; i++) {
                const item = cart[i];
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                let imageHtml = '';
                if (item.imageUrl) {
                    imageHtml = `<img src="${item.imageUrl}" alt="${item.name}" class="cart-item-img">`;
                } else {
                    imageHtml = `<div style="width: 100%; height: 100%; background: var(--light); display: flex; align-items: center; justify-content: center; font-size: 40px;">
                                    ${item.type === 'combo' ? 'üéÅ' : 'üçΩÔ∏è'}
                                </div>`;
                }
                
                itemsHTML += `
                    <div class="cart-item">
                        <div class="cart-item-image">
                            ${imageHtml}
                        </div>
                        <div class="cart-item-info">
                            <div class="cart-item-title">${item.name}</div>
                            <div class="cart-item-price">${currencySymbol} ${item.price.toFixed(2)}</div>
                        </div>
                        <div class="cart-item-controls">
                            <button onclick="updateCartQuantity(${i}, -1)" style="width: 30px; height: 30px; border-radius: 50%; border: 1px solid #ddd; background: white; cursor: pointer;">-</button>
                            <div class="cart-item-qty">${item.quantity}</div>
                            <button onclick="updateCartQuantity(${i}, 1)" style="width: 30px; height: 30px; border-radius: 50%; border: 1px solid #ddd; background: white; cursor: pointer;">+</button>
                            <button onclick="removeFromCart(${i})" style="background: none; border: none; color: var(--accent); cursor: pointer; margin-left: 10px;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = itemsHTML;
            if (subtotalElement) subtotalElement.textContent = `${currencySymbol} ${subtotal.toFixed(2)}`;
            
            if (deliveryElement) {
                if (deliveryPrice) {
                    deliveryElement.textContent = `${currencySymbol} ${deliveryPrice.toFixed(2)}`;
                } else {
                    deliveryElement.textContent = deliveryText;
                }
            }
            
            updateCartTotal(subtotal, deliveryPrice, currencySymbol);
            
            updateAllLanguageElements();
        }

        function updateCartTotal(subtotal, deliveryPrice, currencySymbol) {
            const delivery = deliveryPrice || 0;
            const total = subtotal + delivery;
            const totalElement = document.getElementById('cartPageTotal');
            if (totalElement) {
                totalElement.textContent = `${currencySymbol} ${total.toFixed(2)}`;
            }
        }

        async function updateCartQuantity(index, change) {
            cart[index].quantity += change;
            
            if (cart[index].quantity < 1) {
                cart.splice(index, 1);
            }
            
            try {
                await saveCartToDB();
            } catch (error) {
                console.error('‚ùå Erro ao salvar carrinho:', error);
                localStorage.setItem('nutribalance_cart', JSON.stringify(cart));
            }
            
            updateCartUI();
            updateCartPage();
        }

        async function removeFromCart(index) {
            cart.splice(index, 1);
            
            try {
                await saveCartToDB();
            } catch (error) {
                console.error('‚ùå Erro ao salvar carrinho:', error);
                localStorage.setItem('nutribalance_cart', JSON.stringify(cart));
            }
            
            updateCartUI();
            updateCartPage();
            showNotification(currentLanguage === 'es' ? 'üóëÔ∏è Producto eliminado' : 'üóëÔ∏è Produto removido');
        }

        function openCheckout() {
            if (cart.length === 0) {
                showNotification(currentLanguage === 'es' ? '‚ö†Ô∏è Tu carrito est√° vac√≠o' : '‚ö†Ô∏è Seu carrinho est√° vazio');
                return;
            }
            
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('cartPage').style.display = 'none';
            document.getElementById('checkoutSection').style.display = 'block';
            document.getElementById('clientsSection').style.display = 'none';
            
            const steps = document.querySelectorAll('.step');
            if (steps.length >= 3) {
                steps[0].classList.add('completed');
                steps[1].classList.add('active');
                steps[1].classList.remove('completed');
                steps[2].classList.remove('active', 'completed');
            }
            
            updateAllLanguageElements();
        }

        function goToCartPage() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('cartPage').style.display = 'block';
            document.getElementById('checkoutSection').style.display = 'none';
            document.getElementById('clientsSection').style.display = 'none';
        }

        // ===== ENVIAR PEDIDO PARA WHATSAPP =====
        async function sendOrderToWhatsApp() {
            const deliveryLocation = document.getElementById('deliveryLocation');
            if (!deliveryLocation || !deliveryLocation.value.trim()) {
                showNotification(currentLanguage === 'es' 
                    ? '‚ö†Ô∏è Por favor, ingresa tu direcci√≥n de entrega' 
                    : '‚ö†Ô∏è Por favor, insira seu endere√ßo de entrega');
                return;
            }
            
            const sendOrderBtn = document.getElementById('sendOrderBtn');
            if (!sendOrderBtn) return;
            
            const originalText = sendOrderBtn.innerHTML;
            sendOrderBtn.innerHTML = '<div class="loading-spinner"></div> <span data-es="Enviando..." data-pt="Enviando...">Enviando...</span>';
            sendOrderBtn.disabled = true;
            updateAllLanguageElements();
            
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings') || {};
                
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const delivery = settings.deliveryPrice || 0;
                const total = subtotal + delivery;
                
                let message = '';
                if (currentLanguage === 'es') {
                    message = `*üìç NUEVO PEDIDO - ${settings.businessName || 'NutriBalance'}*\n\n`;
                    message += `*Cliente:* ${currentUser ? currentUser.name : 'Cliente nuevo'}\n`;
                    message += `*Direcci√≥n para entrega:* ${deliveryLocation.value}\n\n`;
                    message += `*üì¶ DETALLES DEL PEDIDO:*\n`;
                    
                    cart.forEach(item => {
                        message += `‚Ä¢ ${item.quantity}x ${item.name} - ${settings.currencySymbol || 'Bs'} ${(item.price * item.quantity).toFixed(2)}\n`;
                    });
                    
                    message += `\n*Valor total del producto:* ${settings.currencySymbol || 'Bs'} ${subtotal.toFixed(2)}\n`;
                    if (settings.deliveryPrice) {
                        message += `*Entrega:* ${settings.currencySymbol || 'Bs'} ${settings.deliveryPrice.toFixed(2)}\n`;
                    } else {
                        message += `*Entrega:* ${settings.deliveryText || 'Calcular via WhatsApp'}\n`;
                    }
                    message += `*üí∞ VALOR TOTAL = ${settings.currencySymbol || 'Bs'} ${subtotal.toFixed(2)} + Frete a calcular*\n\n`;
                    message += `_Pedido realizado el ${new Date().toLocaleDateString('es-ES')} ${new Date().toLocaleTimeString('es-ES')}_\n\n`;
                    
                    message += '‚úÖ *PROCEDIMIENTO PARA PAGO:*\n';
                    message += '1. Le enviaremos el c√≥digo QR del valor total por WhatsApp\n';
                    message += '2. Abra su aplicaci√≥n de pagos\n';
                    message += '3. Seleccione "Pagar con QR"\n';
                    message += '4. Escanee el c√≥digo QR enviado\n';
                    message += '5. Confirme el pago\n';
                    message += '6. Env√≠e el comprobante por WhatsApp\n';
                    message += '7. ¬°Listo! Solo espere que llegue su pedido üöö\n';
                } else {
                    message = `*üìç NOVO PEDIDO - ${settings.businessName || 'NutriBalance'}*\n\n`;
                    message += `*Cliente:* ${currentUser ? currentUser.name : 'Cliente novo'}\n`;
                    message += `*Endere√ßo para entrega:* ${deliveryLocation.value}\n\n`;
                    message += `*üì¶ DETALHES DO PEDIDO:*\n`;
                    
                    cart.forEach(item => {
                        message += `‚Ä¢ ${item.quantity}x ${item.name} - ${settings.currencySymbol || 'R$'} ${(item.price * item.quantity).toFixed(2)}\n`;
                    });
                    
                    message += `\n*Valor total do produto:* ${settings.currencySymbol || 'R$'} ${subtotal.toFixed(2)}\n`;
                    if (settings.deliveryPrice) {
                        message += `*Entrega:* ${settings.currencySymbol || 'R$'} ${settings.deliveryPrice.toFixed(2)}\n`;
                    } else {
                        message += `*Entrega:* ${settings.deliveryText || 'Calcular via WhatsApp'}\n`;
                    }
                    message += `*üí∞ VALOR TOTAL = ${settings.currencySymbol || 'R$'} ${subtotal.toFixed(2)} + Frete a calcular*\n\n`;
                    message += `_Pedido realizado em ${new Date().toLocaleDateString('pt-BR')} ${new Date().toLocaleTimeString('pt-BR')}_\n\n`;
                    
                    message += '‚úÖ *PROCEDIMENTO PARA PAGAMENTO:*\n';
                    message += '1. Enviaremos o c√≥digo QR do valor total por WhatsApp\n';
                    message += '2. Abra seu aplicativo de pagamentos\n';
                    message += '3. Selecione "Pagar com QR"\n';
                    message += '4. Escaneie o c√≥digo QR enviado\n';
                    message += '5. Confirme o pagamento\n';
                    message += '6. Envie o comprovante por WhatsApp\n';
                    message += '7. Pronto! S√≥ aguardar seu pedido chegar üöö\n';
                }
                
                const whatsappNumber = settings.whatsappNumber || '59177123456';
                const cleanNumber = whatsappNumber.replace(/\D/g, '');
                const formattedNumber = cleanNumber.startsWith('591') ? cleanNumber : `591${cleanNumber}`;
                
                const encodedMessage = encodeURIComponent(message);
                const whatsappUrl = `https://wa.me/${formattedNumber}?text=${encodedMessage}`;
                
                if (currentUser && currentUser.type === 'client' && currentUser.clientId) {
                    const order = {
                        clientId: currentUser.clientId,
                        clientName: currentUser.name,
                        items: [...cart],
                        subtotal: subtotal,
                        delivery: delivery,
                        total: total,
                        deliveryAddress: deliveryLocation.value,
                        date: new Date().toISOString(),
                        status: 'pending'
                    };
                    
                    await dbAdd(STORES.ORDERS, order);
                    
                    const client = await dbGet(STORES.CLIENTS, currentUser.clientId);
                    if (client) {
                        client.totalOrders += 1;
                        client.totalSpent += total;
                        client.lastOrderDate = new Date().toISOString();
                        await dbPut(STORES.CLIENTS, client);
                    }
                }
                
                setTimeout(() => {
                    sendOrderBtn.innerHTML = originalText;
                    sendOrderBtn.disabled = false;
                    updateAllLanguageElements();
                    
                    window.open(whatsappUrl, '_blank');
                    
                    cart = [];
                    try {
                        saveCartToDB();
                    } catch (error) {
                        localStorage.setItem('nutribalance_cart', JSON.stringify(cart));
                    }
                    updateCartUI();
                    
                    goToHome();
                    
                    showNotification(currentLanguage === 'es' 
                        ? '‚úÖ ¬°Pedido enviado! Revisa WhatsApp para recibir el c√≥digo QR de pago.'
                        : '‚úÖ Pedido enviado! Verifique o WhatsApp para receber o c√≥digo QR de pagamento.');
                }, 1000);
            } catch (error) {
                console.error('‚ùå Erro ao enviar pedido:', error);
                
                sendOrderBtn.innerHTML = originalText;
                sendOrderBtn.disabled = false;
                updateAllLanguageElements();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al enviar el pedido. Intente nuevamente.'
                    : '‚ùå Erro ao enviar o pedido. Tente novamente.');
            }
        }

        // ===== ADMIN =====
        async function openAdmin() {
            if (!currentUser || currentUser.type !== 'admin') {
                showNotification(currentLanguage === 'es' 
                    ? '‚õî Acceso restringido' 
                    : '‚õî Acesso restrito');
                return;
            }
            
            document.getElementById('adminPanel').style.display = 'block';
            await loadAdminData();
            updateAllLanguageElements();
        }

        function closeAdmin() {
            document.getElementById('adminPanel').style.display = 'none';
            clearForm();
        }

        function showClientsPage() {
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('clientsSection').style.display = 'block';
            loadClients();
        }

        function showRankingsPage() {
            document.getElementById('rankingsSection').style.display = 'block';
            loadRankings();
        }

        function openTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const tabElement = document.getElementById(tabId);
            if (tabElement) {
                tabElement.classList.add('active');
            }
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            if (tabId === 'productsTab') {
                loadProductList();
            } else if (tabId === 'heroImagesTab') {
                loadHeroImages();
            } else if (tabId === 'clientsTab') {
                loadAdminClients();
            } else if (tabId === 'qrCodeTab') {
                loadQRCode();
            } else if (tabId === 'storeInfoTab') {
                loadStoreInfo();
            } else if (tabId === 'settingsTab') {
                loadSettings();
            }
            
            updateAllLanguageElements();
        }

        async function loadAdminData() {
            await loadProductList();
            await loadHeroImages();
            await loadAdminClients();
            await loadQRCode();
            await loadStoreInfo();
            await loadSettings();
        }

        async function loadProductList() {
            try {
                const products = await dbGetAll(STORES.PRODUCTS);
                const combos = await dbGetAll(STORES.COMBOS);
                const allItems = [...products, ...combos];
                
                const container = document.getElementById('adminProductList');
                if (!container) return;
                
                container.innerHTML = allItems.map(item => `
                    <div class="product-item">
                        <div>
                            <strong>${item.type === 'combo' ? 'üéÅ ' : 'üçΩÔ∏è '}${currentLanguage === 'es' ? item.nameEs : item.namePt}</strong><br>
                            <small>${item.type === 'combo' ? 'COMBO' : 'PRODUTO'} - ${item.price ? 'Bs ' + item.price.toFixed(2) : ''}</small>
                        </div>
                        <div class="product-item-actions">
                            <button class="btn-edit" onclick="editProduct(${item.id}, '${item.type}')">‚úèÔ∏è ${currentLanguage === 'es' ? 'Editar' : 'Editar'}</button>
                            <button class="btn-delete" onclick="deleteProduct(${item.id}, '${item.type}')">üóëÔ∏è ${currentLanguage === 'es' ? 'Eliminar' : 'Excluir'}</button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('‚ùå Erro ao carregar lista de produtos:', error);
            }
        }

        async function loadAdminClients() {
            try {
                const clients = await dbGetAll(STORES.CLIENTS);
                const container = document.getElementById('adminClientsList');
                if (!container) return;
                
                const search = document.getElementById('adminSearchClient') ? document.getElementById('adminSearchClient').value.toLowerCase() : '';
                const minOrders = document.getElementById('adminMinOrders') ? parseInt(document.getElementById('adminMinOrders').value) || 0 : 0;
                const minSpent = document.getElementById('adminMinSpent') ? parseFloat(document.getElementById('adminMinSpent').value) || 0 : 0;
                
                let filteredClients = [...clients];
                
                if (search) {
                    filteredClients = filteredClients.filter(client => 
                        client.name.toLowerCase().includes(search) || 
                        (client.email && client.email.toLowerCase().includes(search)) ||
                        (client.phone && client.phone.includes(search))
                    );
                }
                
                filteredClients = filteredClients.filter(client => 
                    (client.totalOrders || 0) >= minOrders && 
                    (client.totalSpent || 0) >= minSpent
                );
                
                container.innerHTML = filteredClients.map(client => {
                    const today = new Date();
                    const clientBirthday = client.birthday ? new Date(client.birthday) : null;
                    const isBirthdayThisMonth = clientBirthday && clientBirthday.getMonth() === today.getMonth();
                    const birthdayBadge = isBirthdayThisMonth ? '<span class="birthday-badge">üéÇ</span>' : '';
                    
                    return `
                        <div class="product-item">
                            <div>
                                <strong>${client.name || 'Sem nome'} ${birthdayBadge}</strong><br>
                                <small>${client.email || 'Sem email'} | ${client.phone || 'Sem telefone'}</small><br>
                                <small>${currentLanguage === 'es' ? 'Registrado:' : 'Registrado:'} ${client.registrationDate ? new Date(client.registrationDate).toLocaleDateString() : 'N/A'}</small>
                            </div>
                            <div class="product-item-actions">
                                <div style="text-align: right;">
                                    <div><strong>${client.totalOrders || 0}</strong> ${currentLanguage === 'es' ? 'pedidos' : 'pedidos'}</div>
                                    <div><strong>${client.totalSpent ? 'Bs ' + client.totalSpent.toFixed(2) : 'Bs 0,00'}</strong></div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                await loadUpcomingBirthdays();
            } catch (error) {
                console.error('‚ùå Erro ao carregar clientes:', error);
            }
        }

        async function loadUpcomingBirthdays() {
            try {
                const clients = await dbGetAll(STORES.CLIENTS);
                const container = document.getElementById('upcomingBirthdays');
                if (!container) return;
                
                const today = new Date();
                const currentMonth = today.getMonth();
                const currentDay = today.getDate();
                
                const upcomingBirthdays = clients.filter(client => {
                    if (!client.birthday) return false;
                    
                    const birthday = new Date(client.birthday);
                    const birthdayMonth = birthday.getMonth();
                    const birthdayDay = birthday.getDate();
                    
                    return (birthdayMonth === currentMonth && birthdayDay >= currentDay) ||
                           (birthdayMonth === (currentMonth + 1) % 12);
                }).sort((a, b) => {
                    const dateA = new Date(a.birthday);
                    const dateB = new Date(b.birthday);
                    return dateA.getMonth() - dateB.getMonth() || dateA.getDate() - dateB.getDate();
                }).slice(0, 5);
                
                if (upcomingBirthdays.length === 0) {
                    container.innerHTML = `<p style="color: var(--gray);">${currentLanguage === 'es' ? 'No hay cumplea√±os pr√≥ximos' : 'N√£o h√° anivers√°rios pr√≥ximos'}</p>`;
                    return;
                }
                
                container.innerHTML = upcomingBirthdays.map(client => {
                    const birthday = new Date(client.birthday);
                    const monthNames = currentLanguage === 'es' 
                        ? ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic']
                        : ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                    
                    return `
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;">
                            <div>
                                <strong>${client.name}</strong><br>
                                <small>${client.phone || 'Sin tel√©fono'}</small>
                            </div>
                            <div style="text-align: right;">
                                <div><strong>${birthday.getDate()} ${monthNames[birthday.getMonth()]}</strong></div>
                                <small>Bs ${(client.totalSpent || 0).toFixed(2)}</small>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('‚ùå Erro ao carregar pr√≥ximos anivers√°rios:', error);
            }
        }

        async function loadHeroImages() {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (settings && settings.heroImages) {
                    const carneUrlInput = document.getElementById('heroCarneUrl');
                    const frangoUrlInput = document.getElementById('heroFrangoUrl');
                    
                    if (carneUrlInput) carneUrlInput.value = settings.heroImages.carne || '';
                    if (frangoUrlInput) frangoUrlInput.value = settings.heroImages.frango || '';
                    
                    updateHeroImagePreview(settings.heroImages.carne, 'heroCarnePreview', 'carnePreviewContainer');
                    updateHeroImagePreview(settings.heroImages.frango, 'heroFrangoPreview', 'frangoPreviewContainer');
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar imagens hero:', error);
            }
        }

        async function loadHeroImagesFromSettings() {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (settings && settings.heroImages) {
                    const carneImage = document.getElementById('carneImage');
                    const frangoImage = document.getElementById('frangoImage');
                    const carneLabel = document.getElementById('carneLabel');
                    const frangoLabel = document.getElementById('frangoLabel');
                    
                    if (carneImage && settings.heroImages.carne) {
                        carneImage.src = settings.heroImages.carne;
                    }
                    if (frangoImage && settings.heroImages.frango) {
                        frangoImage.src = settings.heroImages.frango;
                    }
                    
                    if (carneLabel) {
                        if (settings.heroImages.carneText && settings.heroImages.carneText.trim() !== '') {
                            carneLabel.textContent = settings.heroImages.carneText;
                            carneLabel.style.display = 'block';
                        } else {
                            carneLabel.style.display = 'none';
                        }
                    }
                    
                    if (frangoLabel) {
                        if (settings.heroImages.frangoText && settings.heroImages.frangoText.trim() !== '') {
                            frangoLabel.textContent = settings.heroImages.frangoText;
                            frangoLabel.style.display = 'block';
                        } else {
                            frangoLabel.style.display = 'none';
                        }
                    }
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar imagens hero das configura√ß√µes:', error);
            }
        }

        // ===== FUN√á√ïES DE UPLOAD DE IMAGENS =====
        function uploadImage(input, previewId, urlInputId) {
            const file = input.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification(currentLanguage === 'es' 
                    ? '‚ö†Ô∏è La imagen es demasiado grande (m√°ximo 5MB)' 
                    : '‚ö†Ô∏è A imagem √© muito grande (m√°ximo 5MB)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const dataUrl = e.target.result;
                const preview = document.getElementById(previewId);
                const urlInput = document.getElementById(urlInputId);
                
                if (preview) preview.src = dataUrl;
                if (urlInput) urlInput.value = dataUrl;
            };
            reader.readAsDataURL(file);
        }

        function uploadHeroImage(input, previewId, urlInputId, containerId) {
            const file = input.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification(currentLanguage === 'es' 
                    ? '‚ö†Ô∏è La imagen es demasiado grande (m√°ximo 5MB)' 
                    : '‚ö†Ô∏è A imagem √© muito grande (m√°ximo 5MB)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const dataUrl = e.target.result;
                const preview = document.getElementById(previewId);
                const urlInput = document.getElementById(urlInputId);
                const container = document.getElementById(containerId);
                const placeholder = container.querySelector('div');
                
                if (preview) {
                    preview.src = dataUrl;
                    preview.style.display = 'block';
                }
                if (urlInput) urlInput.value = dataUrl;
                if (placeholder) placeholder.style.display = 'none';
            };
            reader.readAsDataURL(file);
        }

        function updateImagePreview(url, previewId = 'imagePreview') {
            const preview = document.getElementById(previewId);
            if (preview) {
                if (url && url.trim() !== '') {
                    preview.src = url;
                    preview.style.display = 'block';
                } else {
                    preview.style.display = 'none';
                }
            }
        }

        function updateHeroImagePreview(url, previewId, containerId) {
            const preview = document.getElementById(previewId);
            const container = document.getElementById(containerId);
            const placeholder = container.querySelector('div');
            
            if (preview && container) {
                if (url && url.trim() !== '') {
                    preview.src = url;
                    preview.style.display = 'block';
                    if (placeholder) placeholder.style.display = 'none';
                } else {
                    preview.style.display = 'none';
                    if (placeholder) placeholder.style.display = 'flex';
                }
            }
        }

        async function editProduct(id, type) {
            try {
                const storeName = type === 'product' ? STORES.PRODUCTS : STORES.COMBOS;
                const product = await dbGet(storeName, id);
                
                if (!product) return;
                
                const formTitle = document.getElementById('formTitle');
                if (formTitle) formTitle.textContent = currentLanguage === 'es' ? 'Editar Producto' : 'Editar Produto';
                
                document.getElementById('editProductId').value = `${type}-${id}`;
                document.getElementById('productType').value = type;
                document.getElementById('nameEs').value = product.nameEs || '';
                document.getElementById('namePt').value = product.namePt || '';
                document.getElementById('descriptionEs').value = product.descriptionEs || '';
                document.getElementById('descriptionPt').value = product.descriptionPt || '';
                document.getElementById('price').value = product.price || '';
                document.getElementById('calories').value = product.calories || '';
                document.getElementById('protein').value = product.protein || '';
                document.getElementById('carbs').value = product.carbs || '';
                document.getElementById('fat').value = product.fat || '';
                document.getElementById('imageUrl').value = product.imageUrl || '';
                document.getElementById('category').value = product.category || 'carne';
                
                updateImagePreview(product.imageUrl);
                openTab('addProductTab');
            } catch (error) {
                console.error('‚ùå Erro ao editar produto:', error);
            }
        }

        async function deleteProduct(id, type) {
            if (!confirm(currentLanguage === 'es' 
                ? '¬øEst√°s seguro de eliminar este producto?' 
                : 'Tem certeza que deseja excluir este produto?')) return;
            
            try {
                const storeName = type === 'product' ? STORES.PRODUCTS : STORES.COMBOS;
                await dbDelete(storeName, id);
                
                await loadProductList();
                if (type === 'product') {
                    await renderProducts();
                } else {
                    await renderCombos();
                }
                
                showNotification(currentLanguage === 'es' 
                    ? 'üóëÔ∏è Producto eliminado' 
                    : 'üóëÔ∏è Produto exclu√≠do');
            } catch (error) {
                console.error('‚ùå Erro ao excluir produto:', error);
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al eliminar producto' 
                    : '‚ùå Erro ao excluir produto');
            }
        }

        async function saveProduct(event) {
            event.preventDefault();
            event.stopPropagation();
            
            const saveBtn = document.getElementById('saveProductBtn');
            if (!saveBtn) return;
            
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<div class="loading-spinner"></div> <span data-es="Guardando..." data-pt="Salvando...">Guardando...</span>';
            saveBtn.disabled = true;
            updateAllLanguageElements();
            
            try {
                const id = document.getElementById('editProductId').value;
                const type = document.getElementById('productType').value;
                const isEditing = id !== '';
                
                const productData = {
                    id: isEditing ? parseInt(id.split('-')[1]) : await generateId(type),
                    type: type,
                    nameEs: document.getElementById('nameEs').value,
                    namePt: document.getElementById('namePt').value,
                    descriptionEs: document.getElementById('descriptionEs').value,
                    descriptionPt: document.getElementById('descriptionPt').value,
                    price: parseFloat(document.getElementById('price').value),
                    calories: document.getElementById('calories').value ? parseInt(document.getElementById('calories').value) : null,
                    protein: document.getElementById('protein').value ? parseFloat(document.getElementById('protein').value) : null,
                    carbs: document.getElementById('carbs').value ? parseFloat(document.getElementById('carbs').value) : null,
                    fat: document.getElementById('fat').value ? parseFloat(document.getElementById('fat').value) : null,
                    imageUrl: document.getElementById('imageUrl').value,
                    category: document.getElementById('category').value
                };
                
                const storeName = type === 'product' ? STORES.PRODUCTS : STORES.COMBOS;
                await dbPut(storeName, productData);
                
                if (type === 'product') {
                    await renderProducts();
                } else {
                    await renderCombos();
                }
                
                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                    updateAllLanguageElements();
                    
                    clearForm();
                    loadProductList();
                    showNotification(currentLanguage === 'es' 
                        ? '‚úÖ Producto guardado correctamente' 
                        : '‚úÖ Produto salvo com sucesso');
                }, 500);
            } catch (error) {
                console.error('‚ùå Erro ao salvar produto:', error);
                
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
                updateAllLanguageElements();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al guardar producto' 
                    : '‚ùå Erro ao salvar produto');
            }
            
            return false;
        }

        async function generateId(type) {
            try {
                const storeName = type === 'product' ? STORES.PRODUCTS : STORES.COMBOS;
                const items = await dbGetAll(storeName);
                return items.length > 0 ? Math.max(...items.map(p => p.id)) + 1 : (type === 'product' ? 1 : 101);
            } catch (error) {
                console.error('‚ùå Erro ao gerar ID:', error);
                return Date.now();
            }
        }

        function clearForm() {
            const productForm = document.getElementById('productForm');
            if (productForm) productForm.reset();
            
            document.getElementById('editProductId').value = '';
            const formTitle = document.getElementById('formTitle');
            if (formTitle) formTitle.textContent = currentLanguage === 'es' 
                ? 'Agregar Nuevo Producto' 
                : 'Adicionar Novo Produto';
            
            document.getElementById('imagePreview').src = '';
            updateAllLanguageElements();
        }

        // ===== SALVAR IMAGENS HERO =====
        async function saveHeroImages() {
            const saveBtn = document.getElementById('saveHeroImagesBtn');
            if (!saveBtn) return;
            
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<div class="loading-spinner"></div> <span data-es="Guardando..." data-pt="Salvando...">Guardando...</span>';
            saveBtn.disabled = true;
            updateAllLanguageElements();
            
            try {
                const carneUrl = document.getElementById('heroCarneUrl').value;
                const frangoUrl = document.getElementById('heroFrangoUrl').value;
                
                let settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (!settings) {
                    settings = { id: 'app_settings' };
                }
                
                if (!settings.heroImages) {
                    settings.heroImages = {};
                }
                
                if (carneUrl) {
                    settings.heroImages.carne = carneUrl;
                }
                if (frangoUrl) {
                    settings.heroImages.frango = frangoUrl;
                }
                
                await dbPut(STORES.SETTINGS, settings);
                
                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                    updateAllLanguageElements();
                    
                    if (carneUrl) {
                        const carneImage = document.getElementById('carneImage');
                        if (carneImage) carneImage.src = carneUrl;
                    }
                    if (frangoUrl) {
                        const frangoImage = document.getElementById('frangoImage');
                        if (frangoImage) frangoImage.src = frangoUrl;
                    }
                    
                    showNotification(currentLanguage === 'es' 
                        ? '‚úÖ Im√°genes guardadas correctamente' 
                        : '‚úÖ Imagens salvas com sucesso');
                }, 500);
            } catch (error) {
                console.error('‚ùå Erro ao salvar imagens hero:', error);
                
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
                updateAllLanguageElements();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al guardar im√°genes' 
                    : '‚ùå Erro ao salvar imagens');
            }
        }

        async function loadQRCode() {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (settings && settings.qrCode) {
                    const qrcodeUrlInput = document.getElementById('qrcodeUrl');
                    const pixCodeInput = document.getElementById('pixCodeInput');
                    
                    if (qrcodeUrlInput) qrcodeUrlInput.value = settings.qrCode.image || '';
                    if (pixCodeInput) pixCodeInput.value = settings.qrCode.pixCode || '';
                    
                    updateImagePreview(settings.qrCode.image, 'qrcodePreview');
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar QR Code:', error);
            }
        }

        async function loadStoreInfo() {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (settings) {
                    const footerDescriptionInput = document.getElementById('footerDescriptionInput');
                    const instagramInput = document.getElementById('instagramInput');
                    const facebookInput = document.getElementById('facebookInput');
                    const tiktokInput = document.getElementById('tiktokInput');
                    const addressInput = document.getElementById('addressInput');
                    const deliveryTextInput = document.getElementById('deliveryTextInput');
                    const deliveryPriceInput = document.getElementById('deliveryPriceInput');
                    const heroPhraseInput = document.getElementById('heroPhraseInput');
                    
                    if (footerDescriptionInput) footerDescriptionInput.value = settings.storeInfo ? settings.storeInfo.footerDescription || '' : '';
                    if (instagramInput) instagramInput.value = settings.storeInfo ? settings.storeInfo.instagram || '' : '';
                    if (facebookInput) facebookInput.value = settings.storeInfo ? settings.storeInfo.facebook || '' : '';
                    if (tiktokInput) tiktokInput.value = settings.storeInfo ? settings.storeInfo.tiktok || '' : '';
                    if (addressInput) addressInput.value = settings.storeInfo ? settings.storeInfo.address || 'Santa Cruz de la Sierra, Bolivia' : 'Santa Cruz de la Sierra, Bolivia';
                    if (deliveryTextInput) deliveryTextInput.value = settings.deliveryText || 'Calcular via WhatsApp';
                    if (deliveryPriceInput) deliveryPriceInput.value = settings.deliveryPrice || '';
                    
                    if (heroPhraseInput && settings.heroPhrase) {
                        heroPhraseInput.value = settings.heroPhrase.es || '';
                    } else if (heroPhraseInput) {
                        heroPhraseInput.value = '';
                    }
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar informa√ß√µes da loja:', error);
            }
        }

        async function loadSettings() {
            try {
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (settings) {
                    const businessNameInput = document.getElementById('businessName');
                    const whatsappNumberInput = document.getElementById('whatsappNumber');
                    const contactEmailInput = document.getElementById('contactEmail');
                    
                    if (businessNameInput) businessNameInput.value = settings.businessName || 'NutriBalance';
                    if (whatsappNumberInput) whatsappNumberInput.value = settings.whatsappNumber || '59177123456';
                    if (contactEmailInput) contactEmailInput.value = settings.contactEmail || 'hola@nutribalance.com';
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar configura√ß√µes:', error);
            }
        }

        // ===== P√ÅGINA DE CLIENTES (RELAT√ìRIOS) =====
        async function loadClients() {
            try {
                const clients = await dbGetAll(STORES.CLIENTS);
                const search = document.getElementById('searchClient') ? document.getElementById('searchClient').value.toLowerCase() : '';
                const filterMonth = document.getElementById('filterMonth') ? document.getElementById('filterMonth').value : '';
                
                let filteredClients = [...clients];
                
                if (search) {
                    filteredClients = filteredClients.filter(client => 
                        client.name.toLowerCase().includes(search) || 
                        (client.email && client.email.toLowerCase().includes(search)) ||
                        (client.phone && client.phone.includes(search))
                    );
                }
                
                if (filterMonth) {
                    const month = parseInt(filterMonth);
                    filteredClients = filteredClients.filter(client => {
                        if (!client.birthday) return false;
                        const birthday = new Date(client.birthday);
                        return birthday.getMonth() + 1 === month;
                    });
                }
                
                filteredClients.sort((a, b) => (b.totalSpent || 0) - (a.totalSpent || 0));
                
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                const currencySymbol = settings ? settings.currencySymbol : 'Bs';
                
                const totalClients = clients.length;
                const totalOrders = clients.reduce((sum, client) => sum + (client.totalOrders || 0), 0);
                const totalRevenue = clients.reduce((sum, client) => sum + (client.totalSpent || 0), 0);
                
                const today = new Date();
                const currentMonth = today.getMonth() + 1;
                const birthdaysCount = clients.filter(client => {
                    if (!client.birthday) return false;
                    const birthday = new Date(client.birthday);
                    return birthday.getMonth() + 1 === currentMonth;
                }).length;
                
                const totalClientsEl = document.getElementById('totalClients');
                const totalOrdersEl = document.getElementById('totalOrders');
                const totalRevenueEl = document.getElementById('totalRevenue');
                const birthdaysCountEl = document.getElementById('birthdaysCount');
                
                if (totalClientsEl) totalClientsEl.textContent = totalClients;
                if (totalOrdersEl) totalOrdersEl.textContent = totalOrders;
                if (totalRevenueEl) totalRevenueEl.textContent = `${currencySymbol} ${totalRevenue.toFixed(2)}`;
                if (birthdaysCountEl) birthdaysCountEl.textContent = birthdaysCount;
                
                const tableBody = document.getElementById('clientsTableBody');
                if (tableBody) {
                    tableBody.innerHTML = filteredClients.map(client => {
                        let birthday = null;
                        let birthdayFormatted = 'N/A';
                        let isBirthdayThisMonth = false;
                        
                        if (client.birthday) {
                            birthday = new Date(client.birthday);
                            const today = new Date();
                            isBirthdayThisMonth = birthday.getMonth() === today.getMonth();
                            
                            const monthNames = currentLanguage === 'es' 
                                ? ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre']
                                : ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
                            
                            birthdayFormatted = `${birthday.getDate()} ${monthNames[birthday.getMonth()]}`;
                        }
                        
                        const birthdayBadge = isBirthdayThisMonth ? '<span class="birthday-badge">üéÇ Este mes</span>' : '';
                        
                        return `
                            <div class="table-row">
                                <div>
                                    <strong>${client.name || 'Sin nombre'}</strong> ${birthdayBadge}<br>
                                    <small>${client.email || 'Sin email'}<br>${client.phone || 'Sin tel√©fono'}</small>
                                </div>
                                <div>${client.email || 'Sin email'}</div>
                                <div><strong>${client.totalOrders || 0}</strong></div>
                                <div><strong>${currencySymbol} ${(client.totalSpent || 0).toFixed(2)}</strong></div>
                                <div>${birthdayFormatted}</div>
                            </div>
                        `;
                    }).join('');
                }
                
                updateAllLanguageElements();
            } catch (error) {
                console.error('‚ùå Erro ao carregar clientes:', error);
            }
        }

        // ===== RANKINGS DE VENDAS =====
        async function loadRankings() {
            try {
                const clients = await dbGetAll(STORES.CLIENTS);
                const orders = await dbGetAll(STORES.ORDERS);
                const products = await dbGetAll(STORES.PRODUCTS);
                const combos = await dbGetAll(STORES.COMBOS);
                const allItems = [...products, ...combos];
                
                const settings = await dbGet(STORES.SETTINGS, 'app_settings');
                const currencySymbol = settings ? settings.currencySymbol : 'Bs';
                
                const clientRanking = [...clients]
                    .filter(client => client.totalSpent > 0)
                    .sort((a, b) => (b.totalSpent || 0) - (a.totalSpent || 0))
                    .slice(0, 10);
                
                const topClientsContainer = document.getElementById('topClientsRanking');
                if (topClientsContainer) {
                    topClientsContainer.innerHTML = clientRanking.map((client, index) => {
                        const positionColors = ['#FFD700', '#C0C0C0', '#CD7F32', '#4CAF50', '#2196F3'];
                        const bgColor = index < 5 ? positionColors[index] : 'var(--primary)';
                        
                        return `
                            <div class="ranking-item">
                                <div class="ranking-position" style="background: ${bgColor};">
                                    ${index + 1}
                                </div>
                                <div class="ranking-info">
                                    <div class="ranking-name">${client.name || 'Cliente'}</div>
                                    <div class="ranking-value">${currencySymbol} ${(client.totalSpent || 0).toFixed(2)}</div>
                                </div>
                                <div style="text-align: right;">
                                    <small>${client.totalOrders || 0} pedidos</small>
                                </div>
                            </div>
                        `;
                    }).join('');
                    
                    if (clientRanking.length === 0) {
                        topClientsContainer.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 20px;">A√∫n no hay datos de ventas</p>';
                    }
                }
                
                const productSales = {};
                
                orders.forEach(order => {
                    if (order.items && Array.isArray(order.items)) {
                        order.items.forEach(item => {
                            const key = `${item.type}-${item.id}`;
                            if (!productSales[key]) {
                                productSales[key] = {
                                    name: item.name,
                                    type: item.type,
                                    id: item.id,
                                    quantity: 0,
                                    revenue: 0
                                };
                            }
                            productSales[key].quantity += item.quantity;
                            productSales[key].revenue += (item.price * item.quantity);
                        });
                    }
                });
                
                const productRanking = Object.values(productSales)
                    .sort((a, b) => b.quantity - a.quantity)
                    .slice(0, 10);
                
                const topProductsContainer = document.getElementById('topProductsRanking');
                if (topProductsContainer) {
                    if (productRanking.length === 0) {
                        topProductsContainer.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 20px;">A√∫n no hay datos de ventas</p>';
                    } else {
                        let html = '';
                        for (let i = 0; i < productRanking.length; i++) {
                            const product = productRanking[i];
                            const positionColors = ['#FFD700', '#C0C0C0', '#CD7F32', '#4CAF50', '#2196F3'];
                            const bgColor = i < 5 ? positionColors[i] : 'var(--primary)';
                            
                            html += `
                                <div class="ranking-item">
                                    <div class="ranking-position" style="background: ${bgColor};">
                                        ${i + 1}
                                    </div>
                                    <div class="ranking-info">
                                        <div class="ranking-name">${product.name}</div>
                                        <div class="ranking-value">${product.quantity} unidades</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <small>${currencySymbol} ${product.revenue.toFixed(2)}</small>
                                    </div>
                                </div>
                            `;
                        }
                        topProductsContainer.innerHTML = html;
                    }
                }
                
                updateAllLanguageElements();
            } catch (error) {
                console.error('‚ùå Erro ao carregar rankings:', error);
            }
        }

        async function exportClientsReport() {
            try {
                const clients = await dbGetAll(STORES.CLIENTS);
                const orders = await dbGetAll(STORES.ORDERS);
                
                const data = {
                    clients: clients,
                    orders: orders,
                    totalClients: clients.length,
                    totalOrders: clients.reduce((sum, client) => sum + (client.totalOrders || 0), 0),
                    totalRevenue: clients.reduce((sum, client) => sum + (client.totalSpent || 0), 0),
                    exportDate: new Date().toISOString(),
                    language: currentLanguage
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `nutribalance-clientes-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showNotification(currentLanguage === 'es' 
                    ? 'üìä Reporte de clientes exportado' 
                    : 'üìä Relat√≥rio de clientes exportado');
            } catch (error) {
                console.error('‚ùå Erro ao exportar relat√≥rio:', error);
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al exportar reporte' 
                    : '‚ùå Erro ao exportar relat√≥rio');
            }
        }

        // ===== SALVAR QR CODE =====
        async function saveQRCode() {
            const saveBtn = document.getElementById('saveQRCodeBtn');
            if (!saveBtn) return;
            
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<div class="loading-spinner"></div> <span data-es="Guardando..." data-pt="Salvando...">Guardando...</span>';
            saveBtn.disabled = true;
            updateAllLanguageElements();
            
            try {
                const qrUrl = document.getElementById('qrcodeUrl').value;
                const pixCode = document.getElementById('pixCodeInput').value;
                
                let settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (!settings) {
                    settings = { id: 'app_settings' };
                }
                
                if (!settings.qrCode) {
                    settings.qrCode = {};
                }
                
                if (qrUrl) {
                    settings.qrCode.image = qrUrl;
                }
                if (pixCode) {
                    settings.qrCode.pixCode = pixCode;
                }
                
                await dbPut(STORES.SETTINGS, settings);
                
                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                    updateAllLanguageElements();
                    
                    showNotification(currentLanguage === 'es' 
                        ? '‚úÖ QR Code guardado correctamente' 
                        : '‚úÖ QR Code salvo com sucesso');
                }, 500);
            } catch (error) {
                console.error('‚ùå Erro ao salvar QR Code:', error);
                
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
                updateAllLanguageElements();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al guardar QR Code' 
                    : '‚ùå Erro ao salvar QR Code');
            }
        }

        // ===== SALVAR INFORMA√á√ïES DA LOJA =====
        async function saveStoreInfo() {
            const saveBtn = document.getElementById('saveStoreInfoBtn');
            if (!saveBtn) return;
            
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<div class="loading-spinner"></div> <span data-es="Guardando..." data-pt="Salvando...">Guardando...</span>';
            saveBtn.disabled = true;
            updateAllLanguageElements();
            
            try {
                const footerDescription = document.getElementById('footerDescriptionInput').value;
                const instagram = document.getElementById('instagramInput').value;
                const facebook = document.getElementById('facebookInput').value;
                const tiktok = document.getElementById('tiktokInput').value;
                const address = document.getElementById('addressInput').value;
                const deliveryText = document.getElementById('deliveryTextInput').value;
                const deliveryPrice = document.getElementById('deliveryPriceInput').value ? parseFloat(document.getElementById('deliveryPriceInput').value) : null;
                const heroPhrase = document.getElementById('heroPhraseInput').value;
                
                let settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (!settings) {
                    settings = { id: 'app_settings' };
                }
                
                if (!settings.storeInfo) {
                    settings.storeInfo = {};
                }
                
                if (footerDescription) {
                    settings.storeInfo.footerDescription = footerDescription;
                }
                if (instagram) {
                    settings.storeInfo.instagram = instagram;
                }
                if (facebook) {
                    settings.storeInfo.facebook = facebook;
                }
                if (tiktok) {
                    settings.storeInfo.tiktok = tiktok;
                }
                if (address) {
                    settings.storeInfo.address = address;
                }
                if (deliveryText) {
                    settings.deliveryText = deliveryText;
                }
                settings.deliveryPrice = deliveryPrice;
                
                if (!settings.heroPhrase) {
                    settings.heroPhrase = {};
                }
                settings.heroPhrase.es = heroPhrase;
                if (!settings.heroPhrase.pt) {
                    settings.heroPhrase.pt = heroPhrase;
                }
                
                await dbPut(STORES.SETTINGS, settings);
                
                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                    updateAllLanguageElements();
                    
                    updateStoreInfoInFooter(settings);
                    updateCartPage();
                    loadHeroPhraseFromSettings();
                    
                    showNotification(currentLanguage === 'es' 
                        ? '‚úÖ Informaci√≥n de tienda guardada' 
                        : '‚úÖ Informa√ß√£o da loja salva');
                }, 500);
            } catch (error) {
                console.error('‚ùå Erro ao salvar informa√ß√µes da loja:', error);
                
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
                updateAllLanguageElements();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al guardar informaci√≥n' 
                    : '‚ùå Erro ao salvar informa√ß√£o');
            }
        }

        async function updateStoreInfoInFooter(settings = null) {
            try {
                if (!settings) {
                    settings = await dbGet(STORES.SETTINGS, 'app_settings');
                }
                
                if (!settings) return;
                
                const footerDesc = document.getElementById('footerDescription');
                if (footerDesc && settings.storeInfo && settings.storeInfo.footerDescription) {
                    footerDesc.textContent = settings.storeInfo.footerDescription;
                }
                
                const instagramLink = document.getElementById('instagramLink');
                const facebookLink = document.getElementById('facebookLink');
                const tiktokLink = document.getElementById('tiktokLink');
                const whatsappLinkFooter = document.getElementById('whatsappLinkFooter');
                
                if (instagramLink && settings.storeInfo && settings.storeInfo.instagram) {
                    instagramLink.href = settings.storeInfo.instagram;
                }
                if (facebookLink && settings.storeInfo && settings.storeInfo.facebook) {
                    facebookLink.href = settings.storeInfo.facebook;
                }
                if (tiktokLink && settings.storeInfo && settings.storeInfo.tiktok) {
                    tiktokLink.href = settings.storeInfo.tiktok;
                }
                
                const addressText = document.getElementById('footerAddressText');
                if (addressText) {
                    addressText.textContent = settings.storeInfo ? (settings.storeInfo.address || 'Santa Cruz de la Sierra, Bolivia') : 'Santa Cruz de la Sierra, Bolivia';
                }
                
                const whatsappLink = document.getElementById('whatsappFloat');
                const footerWhatsapp = document.getElementById('footerWhatsapp');
                const footerWhatsappNumber = document.getElementById('footerWhatsappNumber');
                
                if (whatsappLink && settings.whatsappNumber) {
                    const cleanNumber = settings.whatsappNumber.replace(/\D/g, '');
                    const formattedNumber = cleanNumber.startsWith('591') ? cleanNumber : `591${cleanNumber}`;
                    whatsappLink.href = `https://wa.me/${formattedNumber}`;
                }
                
                if (footerWhatsapp && settings.whatsappNumber) {
                    const cleanNumber = settings.whatsappNumber.replace(/\D/g, '');
                    const formattedNumber = cleanNumber.startsWith('591') ? cleanNumber : `591${cleanNumber}`;
                    footerWhatsapp.href = `https://wa.me/${formattedNumber}`;
                }
                
                if (footerWhatsappNumber && settings.whatsappNumber) {
                    const cleanNumber = settings.whatsappNumber.replace(/\D/g, '');
                    let displayNumber = cleanNumber;
                    if (cleanNumber.startsWith('591')) {
                        displayNumber = `+591 ${cleanNumber.substring(3, 6)} ${cleanNumber.substring(6, 9)} ${cleanNumber.substring(9)}`;
                    } else {
                        displayNumber = `+${cleanNumber}`;
                    }
                    footerWhatsappNumber.textContent = displayNumber;
                }

                if (whatsappLinkFooter && settings.whatsappNumber) {
                    const cleanNumber = settings.whatsappNumber.replace(/\D/g, '');
                    const formattedNumber = cleanNumber.startsWith('591') ? cleanNumber : `591${cleanNumber}`;
                    whatsappLinkFooter.href = `https://wa.me/${formattedNumber}`;
                }
                
                const footerEmail = document.getElementById('footerEmail');
                const footerEmailText = document.getElementById('footerEmailText');
                
                if (footerEmail && settings.contactEmail) {
                    footerEmail.href = `mailto:${settings.contactEmail}`;
                }
                
                if (footerEmailText && settings.contactEmail) {
                    footerEmailText.textContent = settings.contactEmail;
                }
            } catch (error) {
                console.error('‚ùå Erro ao atualizar informa√ß√µes do rodap√©:', error);
            }
        }

        // ===== SALVAR CONFIGURA√á√ïES =====
        async function saveSettings() {
            const saveBtn = document.getElementById('saveSettingsBtn');
            if (!saveBtn) return;
            
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<div class="loading-spinner"></div> <span data-es="Guardando..." data-pt="Salvando...">Guardando...</span>';
            saveBtn.disabled = true;
            updateAllLanguageElements();
            
            try {
                const businessName = document.getElementById('businessName').value;
                const whatsappNumber = document.getElementById('whatsappNumber').value;
                const contactEmail = document.getElementById('contactEmail').value;
                
                let settings = await dbGet(STORES.SETTINGS, 'app_settings');
                if (!settings) {
                    settings = { id: 'app_settings' };
                }
                
                settings.businessName = businessName;
                settings.whatsappNumber = whatsappNumber;
                settings.contactEmail = contactEmail;
                
                await dbPut(STORES.SETTINGS, settings);
                
                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                    updateAllLanguageElements();
                    
                    updateStoreInfoInFooter(settings);
                    showNotification(currentLanguage === 'es' 
                        ? '‚úÖ Configuraci√≥n guardada' 
                        : '‚úÖ Configura√ß√£o salva');
                }, 500);
            } catch (error) {
                console.error('‚ùå Erro ao salvar configura√ß√µes:', error);
                
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
                updateAllLanguageElements();
                
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al guardar configuraci√≥n' 
                    : '‚ùå Erro ao salvar configura√ß√£o');
            }
        }

        // ===== EXPORTAR/IMPORTAR DADOS =====
        async function exportData() {
            try {
                const settings = await dbGetAll(STORES.SETTINGS);
                const products = await dbGetAll(STORES.PRODUCTS);
                const combos = await dbGetAll(STORES.COMBOS);
                const clients = await dbGetAll(STORES.CLIENTS);
                const orders = await dbGetAll(STORES.ORDERS);
                const users = await dbGetAll(STORES.USERS);
                
                const data = {
                    settings: settings,
                    products: products,
                    combos: combos,
                    clients: clients,
                    orders: orders,
                    users: users,
                    exportDate: new Date().toISOString(),
                    version: DB_VERSION
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `nutribalance-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showNotification(currentLanguage === 'es' 
                    ? 'üì• Base de datos exportada' 
                    : 'üì• Base de dados exportada');
            } catch (error) {
                console.error('‚ùå Erro ao exportar dados:', error);
                showNotification(currentLanguage === 'es' 
                    ? '‚ùå Error al exportar datos' 
                    : '‚ùå Erro ao exportar dados');
            }
        }

        async function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                try {
                    const reader = new FileReader();
                    reader.onload = async (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            
                            if (!confirm(currentLanguage === 'es' 
                                ? '‚ö†Ô∏è ¬øEst√°s seguro de importar estos datos? Se sobrescribir√°n los datos actuales.' 
                                : '‚ö†Ô∏è Tem certeza que deseja importar estes dados? Os dados atuais ser√£o sobrescritos.')) return;
                            
                            if (data.settings) {
                                for (const item of data.settings) {
                                    await dbPut(STORES.SETTINGS, item);
                                }
                            }
                            
                            if (data.products) {
                                for (const item of data.products) {
                                    await dbPut(STORES.PRODUCTS, item);
                                }
                            }
                            
                            if (data.combos) {
                                for (const item of data.combos) {
                                    await dbPut(STORES.COMBOS, item);
                                }
                            }
                            
                            if (data.clients) {
                                for (const item of data.clients) {
                                    await dbPut(STORES.CLIENTS, item);
                                }
                            }
                            
                            if (data.orders) {
                                for (const item of data.orders) {
                                    await dbPut(STORES.ORDERS, item);
                                }
                            }
                            
                            if (data.users) {
                                for (const item of data.users) {
                                    await dbPut(STORES.USERS, item);
                                }
                            }
                            
                            showNotification(currentLanguage === 'es' 
                                ? '‚úÖ Datos importados correctamente' 
                                : '‚úÖ Dados importados com sucesso');
                            
                            location.reload();
                        } catch (error) {
                            console.error('‚ùå Erro ao parsear arquivo:', error);
                            showNotification(currentLanguage === 'es' 
                                ? '‚ùå Archivo inv√°lido' 
                                : '‚ùå Arquivo inv√°lido');
                        }
                    };
                    reader.readAsText(file);
                } catch (error) {
                    console.error('‚ùå Erro ao importar dados:', error);
                    showNotification(currentLanguage === 'es' 
                        ? '‚ùå Error al importar datos' 
                        : '‚ùå Erro ao importar dados');
                }
            };
            
            input.click();
        }

        // ===== NOTIFICA√á√ïES =====
        function showNotification(message) {
            const existingNotification = document.querySelector('.custom-notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = 'custom-notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // ===== INICIALIZA√á√ÉO =====
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ Inicializando NutriBalance com todas as corre√ß√µes e FOTOS ATUALIZADAS!');
            
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                const debugTools = document.getElementById('debugTools');
                if (debugTools) debugTools.style.display = 'block';
            }
            
            await initDatabase();
            
            updateAllLanguageElements();
            
            window.addEventListener('scroll', function() {
                const header = document.getElementById('header');
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section');
                    if (sectionId) {
                        goToSection(sectionId);
                    }
                });
            });
            
            console.log('‚úÖ Aplica√ß√£o inicializada com sucesso! Todas as fotos do Imgur est√£o carregadas.');
        });
    </script>
</body>
</html>

